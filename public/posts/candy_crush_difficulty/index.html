<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Leveling Difficulty in Candy Crush Saga - Roberto Aguilar</title><meta name="description" content="From 15 levels of a Candy Crush episode we&#39;ll see how to level the difficulty using Bernoulli principles with Python and Jupyter Notebooks"><meta property="og:title" content="Leveling Difficulty in Candy Crush Saga" />
<meta property="og:description" content="From 15 levels of a Candy Crush episode we&#39;ll see how to level the difficulty using Bernoulli principles with Python and Jupyter Notebooks" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://robguilar.com/posts/candy_crush_difficulty/" /><meta property="og:image" content="https://robguilar.com/images/posts/candy_crush_difficulty.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-19T21:57:40+08:00" />
<meta property="article:modified_time" content="2022-04-20T15:22:50-06:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://robguilar.com/images/posts/candy_crush_difficulty.jpg"/>

<meta name="twitter:title" content="Leveling Difficulty in Candy Crush Saga"/>
<meta name="twitter:description" content="From 15 levels of a Candy Crush episode we&#39;ll see how to level the difficulty using Bernoulli principles with Python and Jupyter Notebooks"/>
<meta name="application-name" content="&gt; robguilar">
<meta name="apple-mobile-web-app-title" content="&gt; robguilar"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#525252"><link rel="shortcut icon" type="image/x-icon" href="https://robguilar.com/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="https://robguilar.com/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://robguilar.com/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="https://robguilar.com/apple-touch-icon.png"><link rel="mask-icon" href="https://robguilar.com/safari-pinned-tab.svg" color="#525252"><link rel="manifest" href="https://robguilar.com/site.webmanifest"><link rel="canonical" href="https://robguilar.com/posts/candy_crush_difficulty/" /><link rel="prev" href="https://robguilar.com/posts/ab_testing_cookiecats/" /><link rel="stylesheet" href="https://robguilar.com/css/page.min.css"><link rel="stylesheet" href="https://robguilar.com/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Leveling Difficulty in Candy Crush Saga",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/robguilar.com\/posts\/candy_crush_difficulty\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/robguilar.com\/images\/logo.png",
                            "width":  1977 ,
                            "height":  2014 
                        }],"genre": "posts","keywords": "Bernoulli, Python","wordcount":  2637 ,
        "url": "https:\/\/robguilar.com\/posts\/candy_crush_difficulty\/","datePublished": "2022-04-19T21:57:40+08:00","dateModified": "2022-04-20T15:22:50-06:00","license": "This work is developed and posted only under Roberto's property","publisher": {
            "@type": "Organization",
            "name": "Roberto Aguilar","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/robguilar.com\/images\/logo.png",
                    "width":  1977 ,
                    "height":  2014 
                }},"author": {
                "@type": "Person",
                "name": "Roberto Aguilar"
            },"description": "From 15 levels of a Candy Crush episode we'll see how to level the difficulty using Bernoulli principles with Python and Jupyter Notebooks"
    }
    </script></head><body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="https://robguilar.com/" title="Roberto Aguilar"><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="https://robguilar.com/posts/" title="Timeline"> Timeline </a><a class="menu-item" href="https://robguilar.com/categories/" title="Projects"> Projects </a><a class="menu-item" href="https://robguilar.com/tags/" title="Tags"> Tags </a><a class="menu-item" href="https://robguilar.com/about/" title="About"> About </a><a class="menu-item" href="https://github.com/robguilarr/" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i> GitHub </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="https://robguilar.com/" title="Roberto Aguilar"><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="https://robguilar.com/posts/" title="Timeline">Timeline</a><a class="menu-item" href="https://robguilar.com/categories/" title="Projects">Projects</a><a class="menu-item" href="https://robguilar.com/tags/" title="Tags">Tags</a><a class="menu-item" href="https://robguilar.com/about/" title="About">About</a><a class="menu-item" href="https://github.com/robguilarr/" title="" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>GitHub</a><div class="menu-item"><a href="javascript:void(0);" class="theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="enable"><div class="single-card" ><h2 class="single-title animated flipInX">Leveling Difficulty in Candy Crush Saga</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="https://robguilar.com/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Roberto Aguilar</a></span>&nbsp;<span class="post-category">published in <a href="https://robguilar.com/categories/projects/"><i class="far fa-folder fa-fw"></i>Projects</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-04-19">2022-04-19</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2637 words</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;13 minutes</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>Contents</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#-introduction-to-problem">⚠️ Introduction to problem</a>
      <ul>
        <li><a href="#hypothesis">Hypothesis</a></li>
        <li><a href="#potential-stakeholders">Potential Stakeholders</a></li>
      </ul>
    </li>
    <li><a href="#-about-the-data">📥 About the data</a>
      <ul>
        <li><a href="#collection-process-and-structure">Collection process and structure</a></li>
      </ul>
    </li>
    <li><a href="#-data-preprocessing">🔧 Data Preprocessing</a>
      <ul>
        <li><a href="#data-cleaning">Data Cleaning</a></li>
        <li><a href="#data-consistency">Data Consistency</a></li>
        <li><a href="#normalization">Normalization</a></li>
      </ul>
    </li>
    <li><a href="#-exploratory-analysis--in-game-interpretations">🔍 Exploratory Analysis &amp; In-game interpretations</a>
      <ul>
        <li><a href="#summary-statistics">Summary statistics</a></li>
        <li><a href="#levels-played-in-episode">Levels played in Episode</a></li>
        <li><a href="#difficulty-of-completing-a-level-in-a-single-try">Difficulty of completing a level in a single try</a></li>
        <li><a href="#defining-hard-levels">Defining hard levels</a></li>
        <li><a href="#measuring-the-uncertainty-of-success">Measuring the uncertainty of success</a></li>
      </ul>
    </li>
    <li><a href="#-final-thoughts--takeaways">🗒️ Final thoughts &amp; takeaways</a></li>
    <li><a href="#ℹ-additional-information">ℹ️ Additional Information</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><p>Today&rsquo;s analysis will lead us to a world fulfilled with divine puzzle adventures at the side of Tiffi and Mr. Toffee, in which we&rsquo;ll glimpse the success rate of more than 6800 peers with eagerness for treats.</p>
<p>The game is <a href="https://www.king.com/game/candycrush" target="_blank" rel="noopener noreffer">Candy Crush Saga</a> a record-breaking mobile game developed by King, a subsidiary of Activision Blizzard since 2016.</p>
<p>In terms of its gameplay, this game used to have a total of 816 episodes, until one of the major add-ons was removed (Dreamworld). The point is that now the game has 771 episodes, in which the player has 5 episodes per world, and, each episode contains contain 15 levels approximately.</p>
<p>If you are one of the few that haven&rsquo;t played Candy Crush, here&rsquo;s a short intro:</p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>Looking for an interactive experience?<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">🚀 Download the Jupyter Notebook, available <a href="https://nbviewer.org/github/robguilarr/candy_crush_difficulty/blob/master/notebook.ipynb">here</a></div>
        </div>
    </div>

<div class="video">
  <iframe src="https://www.youtube-nocookie.com/embed/HGLGxnfs_t8" allow="fullscreen" title="YouTube Video"></iframe>
</div>

<h2 id="-introduction-to-problem">⚠️ Introduction to problem</h2>
<h3 id="hypothesis">Hypothesis</h3>
<p>We&rsquo;ll review a game that potentially can lead any developer to many unseen problems, considering the abundance of levels. From the perspective of a customer, there can be several points of view that can emerge and, at the same time, can become unnoticed. That&rsquo;s why our diagnosis will start from 2 potential hypothesis</p>
<ol>
<li>The game is too easy so it became boring over time</li>
<li>The game is too hard so the players leave it and become frustrated</li>
</ol>
<p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/map.png" style="width: 700px"></p>
<h3 id="potential-stakeholders">Potential Stakeholders</h3>
<p>None of the past hypotheses are the main intentions of the developers. So they require a Data Analyst to help with this task since the developers are seeing only the backend factors affecting the game, but it&rsquo;s also critical to consider those external ones that affect the experience for the player and the sustainability of this game for the company. Among the main stakeholders could be:</p>
<ul>
<li>Level Designers: as they worked aligned with the rest of the Development Team, they still have a backend perspective and their feedback depends on a <a href="https://grux.org/what-is-gurux/#:~:text=Games%20User%20Research%2FExperience%20focuses,the%20best%20gaming%20experience%20possible." target="_blank" rel="noopener noreffer">UX Research team</a>. To avoid this, they need a report of the player&rsquo;s behavior to adopt a constant-reactive improvement during the post-production stage</li>
<li>Parent Company: Besides Candy Crush being an IP with internal producers since it&rsquo;s developed and published by King, the <a href="https://www.activisionblizzard.com/" target="_blank" rel="noopener noreffer">Parent company</a> will expect to have an <a href="https://www.forbes.com/advisor/investing/roi-return-on-investment/" target="_blank" rel="noopener noreffer">ROI</a> aligned with their expectations.
This is a game whose main income input is in-game purchases because it’s a <a href="https://en.wikipedia.org/wiki/Free-to-play" target="_blank" rel="noopener noreffer">F2P</a>, reason why their main investors are extremely focused in retain the engagement in the game and keeping the consumers on the screen</li>
<li>Players community: they expect to have an endurable and great experience and a brief response in case of problems</li>
</ul>
<h2 id="-about-the-data">📥 About the data</h2>
<h3 id="collection-process-and-structure">Collection process and structure</h3>
<p>Before start let’s import the libraries we’re going to need</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># For visualization</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># Own layout design library</span>
<span class="kn">from</span> <span class="nn">vizformatter.standards</span> <span class="kn">import</span> <span class="n">layout_plotly</span>

<span class="c1"># Load layout base objects</span>
<span class="n">sign</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">720</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Due to the extensive size of possible episodes to analyze, we’ll limit the analysis to just one of them, which exactly will have data available for 15 levels. To do this, the analysts need to request a sample from the telemetry systems to get data related to the number of attempts per player in each episode level</p>
<p>Also, it’s important to mention that in terms of privacy, this analysis requires importing the data with the <em>player_id</em> codified for privacy reasons. Fortunately, in this case, Rasmus Baath, Data Science Lead at <a href="https://castle.io/" target="_blank" rel="noopener noreffer">castle.io</a>, provided us with a Dataset with a sample gathered in 2014</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;datasets/candy_crush.csv&#34;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="https://robguilar.com/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table1.png"
        data-srcset="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table1.png, https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table1.png 1.5x, https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table1.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table1.png"
        title="table1" /></p>
<p>We can see that our data is <strong>structured</strong> and consists of 5 attributes:</p>
<ul>
<li><em>player_id</em>: a unique player id</li>
<li><em>dt</em>: the date</li>
<li><em>level</em>: the level number within the episode, from 1 to 15</li>
<li><em>num_attempts</em>: number of level attempts for the player on that level and date</li>
<li><em>num_success</em>: number of level attempts that resulted in a success/win for the player on that level and date</li>
</ul>
<h2 id="-data-preprocessing">🔧 Data Preprocessing</h2>
<p>Before starting the analysis we need to do some validations on the dataset</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Count and display the number of unique players</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Number of players: </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">player_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s2">&#34;Number of records: </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">player_id</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Display the date range of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Period for which we have data: </span><span class="se">\n</span><span class="s2">From: &#34;</span><span class="p">,</span>
        <span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dt</span><span class="p">),</span> <span class="s1">&#39; To:&#39;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dt</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Number of players: 
 6814 
 Number of records: 
 16865 

Period for which we have data: 
From:  2014-01-01  To: 2014-01-07
</code></pre></td></tr></table>
</div>
</div><h3 id="data-cleaning">Data Cleaning</h3>
<p>The data doesn’t require any kind of transformation and the data types are aligned with their purpose</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">player_id       object
dt              object
level            int64
num_attempts     int64
num_success      int64
dtype: object
</code></pre></td></tr></table>
</div>
</div><h3 id="data-consistency">Data Consistency</h3>
<p>The usability of the data it’s rather good, since we don’t count with “NAN” (Not A Number), “NA” (Not Available), or “NULL” (an empty set) values</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Function the plot the percentage of missing values</span>
<span class="k">def</span> <span class="nf">na_counter</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;NaN Values per column:&#34;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>

        <span class="c1"># Only return columns with more than 5% of NA values</span>
        <span class="k">if</span> <span class="n">percentage</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="s2">&#34; has &#34;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">percentage</span><span class="p">))</span> <span class="o">+</span><span class="s2">&#34;</span><span class="si">% o</span><span class="s2">f Null Values&#34;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>

<span class="c1"># Execute function</span>
<span class="n">na_counter</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">NaN Values per column:
 None
</code></pre></td></tr></table>
</div>
</div><p>By this way, we can conclude that there were not errors in our telemetry logs during the data collection</p>
<h3 id="normalization">Normalization</h3>
<p>Next, we can conclude there were no impossible numbers, except for a player that tried to complete the level 11 in 258 attempts with just 1 success. This is the only registry we exclude since it can be an influential outlier and we don’t rely on more attributes about him to create conclusions</p>
<p>Noticing the distribution of the quartiles and comprehending the purpose of our analysis, we can validate that the data is comparable and doesn’t need transformations</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">num_attempts</span> <span class="o">!=</span> <span class="mi">258</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="https://robguilar.com/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table2.png"
        data-srcset="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table2.png, https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table2.png 1.5x, https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table2.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table2.png"
        title="table2" /></p>
<h2 id="-exploratory-analysis--in-game-interpretations">🔍 Exploratory Analysis &amp; In-game interpretations</h2>
<h3 id="summary-statistics">Summary statistics</h3>
<p>Excluding the outliers we mentioned before, we got the next conclusions about their distribution and measurement:</p>
<ul>
<li><em>player_id</em>
<ul>
<li>Interpretation: Not unique and counts with 6814 distinct values which make sense since there is a player with records of multiple levels</li>
<li>Data type: Nominal</li>
<li>Measurement type: Discrete/String</li>
</ul>
</li>
<li><em>dt</em>
<ul>
<li>Interpretation: Only includes data from January 1st to January 7th of 2014. Also, the analysis won’t consider this as a lapse per player since the records per player are not continuous, so they will be limited as a timestamp</li>
<li>Data type: Ordinal</li>
<li>Measurement type: Temporal</li>
</ul>
</li>
<li><em>level</em>
<ul>
<li>Interpretation: They&rsquo;re registered as numbers, but for further analysis will be transformed as factors. 50% of the records are equal to or less than level 9</li>
<li>Data type: Ordinal</li>
<li>Measurement type: Discrete/String</li>
</ul>
</li>
<li><em>num_attempts</em>
<ul>
<li>Interpretation: The registries are consistent, the interquartile range mention that half of the players try between 1 and 7 time to complete each level. Furthermore, there are players with 0 attempts, so we need to evaluate if this is present at level 1, which can explain a problem in retention rate for that episode</li>
<li>Data type: Numerical</li>
<li>Measurement type: Integer</li>
</ul>
</li>
<li><em>num_success</em>
<ul>
<li>Interpretation: Most of the players are casual gamers because 75% of them complete the level and don’t repeat it</li>
<li>Data type: Numerical</li>
<li>Measurement type: Integer</li>
</ul>
</li>
</ul>
<h3 id="levels-played-in-episode">Levels played in Episode</h3>
<p>First, let’s examine the number of registries per player</p>
<p>This will tell us, from the episode how many levels have each player recorded in the lapse of 7 days</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>

<span class="c1"># Group data of amount of levels recorded by player id</span>
<span class="n">countdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;player_id&#39;</span><span class="p">)[</span><span class="s1">&#39;level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Count the number amount of players according to amount of levels recorded by player</span>
<span class="n">countdf</span> <span class="o">=</span> <span class="n">countdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)[</span><span class="s1">&#39;player_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Arrange data according to amount of levels</span>
<span class="n">countdf</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">countdf</span><span class="o">.</span><span class="n">level</span><span class="p">]</span>
<span class="n">countdf</span> <span class="o">=</span> <span class="n">countdf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;player_id&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># Generate CumSum</span>
<span class="n">cumulative_per</span> <span class="o">=</span>  <span class="n">countdf</span><span class="o">.</span><span class="n">player_id</span> <span class="o">/</span> <span class="n">countdf</span><span class="o">.</span><span class="n">player_id</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">cumulative_per</span> <span class="o">=</span> <span class="n">cumulative_per</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="c1"># Format new DF</span>
<span class="n">countdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">countdf</span><span class="p">,</span> <span class="n">cumulative_per</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">countdf</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;levels&#34;</span><span class="p">,</span><span class="s2">&#34;players&#34;</span><span class="p">,</span><span class="s2">&#34;Cum_per&#34;</span><span class="p">]</span>

<span class="c1"># Pareto Chart</span>
<span class="n">linec</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="p">[[{</span><span class="s2">&#34;secondary_y&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}]])</span>

<span class="c1"># Bar plot graphic object</span>
<span class="n">linec</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">countdf</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">countdf</span><span class="o">.</span><span class="n">players</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Players&#34;</span><span class="p">,</span> <span class="n">marker_color</span><span class="o">=</span> <span class="s2">&#34;#007FFF&#34;</span><span class="p">),</span>
                        <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># Scatter plot graphic object</span>
<span class="n">linec</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">countdf</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">countdf</span><span class="o">.</span><span class="n">Cum_per</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Percentage&#34;</span><span class="p">,</span> <span class="n">marker_color</span><span class="o">=</span> <span class="s2">&#34;#FF5A5F&#34;</span><span class="p">),</span>
                        <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Layout</span>
<span class="n">linec</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="s1">&#39;Pareto Chart of Number of Levels recorded by player&#39;</span><span class="p">},</span>
                    <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;Number of Levels recorded&#34;</span><span class="p">},</span>
                    <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;Unique players&#34;</span><span class="p">})</span>
<span class="n">linec</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">linec</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">tickformat</span> <span class="o">=</span> <span class="s2">&#34;0%&#34;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&#34;Cumulative Percentage&#34;</span><span class="p">,</span> <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">linec</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">linec</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">line_dash</span> <span class="o">=</span> <span class="s2">&#34;dash&#34;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&#34;red&#34;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">linec</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">linec</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/pareto.png" style="width: 900px"></p>
<p>From the last Pareto chart, we can deduce that 80% of the 6814 players just count with 3 levels recorded of 15. But, since this was extracted from a random sample, this won’t affect our study</p>
<h3 id="difficulty-of-completing-a-level-in-a-single-try">Difficulty of completing a level in a single try</h3>
<p>There is a combination of easier and challenging levels. Chance and skills make the number of attempts required to pass a level different from one player to another. The presumption is that difficult levels demand more tries on average than easier ones. That is, the harder a level is the lower the likelihood to pass that level in a single try</p>
<p>In these circumstances, the <a href="https://en.wikipedia.org/wiki/Bernoulli_process" target="_blank" rel="noopener noreffer">Bernoulli process</a> might be useful. As a <em>Boolean</em> result, there are only two possibilities, win or lose. This can be measured by a single parameter:</p>
<p>$p_{win} = \frac{\Sigma wins }{\Sigma attempts }$:  the probability of completing the level in a single attempt</p>
<p>Let&rsquo;s calculate the difficulty $p_{win}$ individually for each of the 15 levels</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">difficulty</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">attempts</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;num_attempts&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">),</span>
                                    <span class="n">wins</span> <span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_success&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">difficulty</span><span class="p">[</span><span class="s1">&#39;p_win&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">difficulty</span><span class="o">.</span><span class="n">wins</span> <span class="o">/</span> <span class="n">difficulty</span><span class="o">.</span><span class="n">attempts</span>
<span class="n">difficulty</span>
</code></pre></td></tr></table>
</div>
</div><p align="left"><img src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table3.png" style="width: 250px"></p>
<p>We have levels where 50% of players finished on the first attempt and others that are the opposite. But let’s visualize it through the episode, to make it clear</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Lineplot of Success Probability per Level</span>
<span class="n">line1</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">difficulty</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&#34;p_win&#34;</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s2">&#34;Probability of Level Success at first attempt&#34;</span><span class="p">,</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;p_win&#34;</span><span class="p">:</span><span class="s2">&#34;Probability&#34;</span><span class="p">,</span> <span class="s2">&#34;level&#34;</span><span class="p">:</span><span class="s2">&#34;Episode Level&#34;</span><span class="p">})</span>
<span class="n">line1</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">line1</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span> <span class="n">tick0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtick</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">line1</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.7</span><span class="p">],</span> <span class="n">tick0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dtick</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">line1</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">yaxis_tickformat</span> <span class="o">=</span> <span class="s2">&#34;0%&#34;</span><span class="p">)</span>
<span class="n">line1</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">line1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/line1.png" style="width: 900px"></p>
<h3 id="defining-hard-levels">Defining hard levels</h3>
<p>It’s subjective what we can consider a hard level because not consistently depends on a single factor and for all player profile groups this can be different. So, for the outcomes of this study, we will arbitrarily assume that a difficult level is the one that has a probability to be completed in the first attempt of a 10% ($p_{win} &lt; 10%$)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Lineplot of Success Probability per Level</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">difficulty</span><span class="o">.</span><span class="n">level</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">difficulty</span><span class="o">.</span><span class="n">p_win</span><span class="p">))</span>
<span class="n">line2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="s1">&#39;Probability of Level Success at first attempt with Hard Levels&#39;</span><span class="p">},</span>
                    <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;Episode Level&#34;</span><span class="p">},</span>
                    <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;Probability&#34;</span><span class="p">})</span>
<span class="n">line2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">line2</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span> <span class="n">tick0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtick</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">line2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">yaxis_tickformat</span> <span class="o">=</span> <span class="s2">&#34;0%&#34;</span><span class="p">)</span>
<span class="n">line2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">line2</span><span class="o">.</span><span class="n">add_hrect</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;red&#34;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">line2</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">line2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/line2.png" style="width: 900px"></p>
<p>From our predefined threshold, we see that the level digit is not aligned with its difficulty. While we have hard levels as 5, 8, 9, and 15; others like 13 and 15 are unleveraged and need to be rebalanced by the level designers</p>
<h3 id="measuring-the-uncertainty-of-success">Measuring the uncertainty of success</h3>
<p>We should always report some calculation of the uncertainty of any provided numbers. Simply, because another sample will give us little different values for the difficulties measured by level.</p>
<p>Here we will simply use the <a href="https://en.wikipedia.org/wiki/Standard_error" target="_blank" rel="noopener noreffer">Standard error</a> as a measure of uncertainty:</p>
<p>$\sigma_{error} \approx \frac{\sigma_{sample}}{\sqrt{n}}$</p>
<p>Here n is the number of datapoints and $\sigma_{sample}$ is the sample standard deviation. For a Bernoulli process, the sample standard deviation is:</p>
<p>$\sigma_{sample} = \sqrt{p_{win}(1-p_{win})}$</p>
<p>Therefore, we can calculate the standard error like this:</p>
<p>$\sigma_{error} \approx \sqrt{\frac{p_{win}(1-p_{win})}{n} }$</p>
<p>Consider that every level has been played <em>n</em> number of times and we have their difficulty $p_{win}$. Now, let&rsquo;s calculate the standard error for each level of this episode</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Computing the standard error of p_win for each level</span>
<span class="n">difficulty</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">difficulty</span><span class="o">.</span><span class="n">p_win</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">difficulty</span><span class="o">.</span><span class="n">p_win</span><span class="p">)</span> <span class="o">/</span> <span class="n">difficulty</span><span class="o">.</span><span class="n">attempts</span><span class="p">)</span>
<span class="n">difficulty</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="https://robguilar.com/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table4.png"
        data-srcset="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table4.png, https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table4.png 1.5x, https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table4.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/table4.png"
        title="table4" /></p>
<p>We have a measure of uncertainty for each levels' difficulty. As always, this would be more appealing if we plot it.</p>
<p>Let&rsquo;s use <em>error bars</em> to show this uncertainty in the plot. We will set the height of the error bars to one standard error. The upper limit and the lower limit of each error bar should be defined by:</p>
<p>$p_{win}  \pm \sigma_{error}$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Lineplot of Success Probability per Level</span>
<span class="n">line3</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">difficulty</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&#34;p_win&#34;</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s2">&#34;Probability of Level Success at first attempt with Error Bars&#34;</span><span class="p">,</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;p_win&#34;</span><span class="p">:</span><span class="s2">&#34;Probability&#34;</span><span class="p">,</span> <span class="s2">&#34;level&#34;</span><span class="p">:</span><span class="s2">&#34;Episode Level&#34;</span><span class="p">},</span>
                <span class="n">error_y</span><span class="o">=</span><span class="s2">&#34;error&#34;</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span> <span class="n">tick0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtick</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.65</span><span class="p">],</span> <span class="n">tick0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dtick</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">yaxis_tickformat</span> <span class="o">=</span> <span class="s2">&#34;0%&#34;</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">add_hrect</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;red&#34;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">line3</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/candy_crush_difficulty/master/plots/line3.png" style="width: 900px"></p>
<p>Looks like the difficulty estimates a very exact. Furthermore, for the hardest levels, the measure is even more precise, and that’s a good point because from this we can make valid conclusions based on that levels</p>
<p>As a curious fact, also we can measure the probability of completing all the levels of that episode in a single attempt, just for fun</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># The probability of completing the episode without losing a single time</span>
<span class="n">prob</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">difficulty</span><span class="o">.</span><span class="n">p_win</span><span class="p">:</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">prob</span><span class="o">*</span><span class="n">i</span>

<span class="c1"># Printing it out</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Probability of Success in one single attempt </span><span class="se">\n</span><span class="s2">for whole episode: &#34;</span><span class="p">,</span> <span class="n">prob</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&#34;%&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Probability of Success in one single attempt 
for whole episode:  9.889123140886191e-10 %
</code></pre></td></tr></table>
</div>
</div><h2 id="-final-thoughts--takeaways">🗒️ Final thoughts &amp; takeaways</h2>
<p><strong>What can the stakeholders understand and take into consideration?</strong></p>
<p>From the sample extracted we conclude that just 33% of the levels are considered of high difficulty, which it’s acceptable since each episode counts with 15 levels, so by now the level designer should not worry about leveling the difficulty</p>
<p><strong>What could the stakeholders do to take action ?</strong></p>
<p>As a suggestion, in the case that the Publisher decides to invest more in in-game mechanics, a solution for a long-time and reactive engagement could be the use of Machine Learning to generate a <a href="https://en.wikipedia.org/wiki/Dynamic_game_difficulty_balancing" target="_blank" rel="noopener noreffer">DGDB</a> as some competitors have adapted in IPs like EA Sports FIFA, Madden NFL or the “AI Director” of Left 4 Dead</p>
<p><strong>What can stakeholders keep working on?</strong></p>
<p>The way their level difficulty design work today is precise since our first hypothesis was that the game wasn’t too linear to unengaged the player and churn as consequence. Because as we saw, the game has drastic variations in the levels 5-6 and 8-10, which can help to avoid frustrations in players</p>
<hr>
<h2 id="ℹ-additional-information">ℹ️ Additional Information</h2>
<ul>
<li><strong>About the article</strong></li>
</ul>
<p>Based on the dataset provided, we will not proceed with a retention analysis as mentioned above. Because the data is from a random episode, if this were episode one, this type of analysis could be useful as it can explain the pool of players who log in, created an account, or install the game but never start playing, causing traction problems. Therefore, this will be left as a limitation to the scope of the analysis.</p>
<p>With acknowledgment to Rasmus Baraath for guiding this project. Which was developed for sharing knowledge while using cited sources of the material used.</p>
<p>Thanks to you for reading as well.</p>
<ul>
<li><strong>Related Content</strong></li>
</ul>
<p>— Rasmus Baath personal <a href="https://www.sumsar.net/" target="_blank" rel="noopener noreffer">blog</a></p>
<p>— Anders Drachen personal <a href="https://andersdrachen.com/" target="_blank" rel="noopener noreffer">website</a></p>
<ul>
<li><strong>Datasets</strong></li>
</ul>
<p>This project was developed with a dataset provided by Rasmus Baraath, which also can be downloaded at my <a href="https://github.com/robguilarr/candy_crush_difficulty/tree/master/datasets">Github</a> repository.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="https://robguilar.com/tags/bernoulli/">Bernoulli</a>
                </span><span><a href="https://robguilar.com/tags/python/">Python</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>Updated on 2022-04-20&nbsp;<a class="git-hash" href="https://github.com/robguilarr/robguilar/commit/fb37ec90d1b311b9e1e98e369cd941cb4a708b2d" target="_blank" title="committed&nbsp;by&nbsp;robguilarr(roberto.aq@outlook.com)&nbsp;fb37ec9:&nbsp;CC Updated">
                            <i class="fas fa-hashtag fa-fw"></i>fb37ec9</a></span>
            </div><div class="post-info-mod"><span>
                            <a class="link-to-markdown" href="https://robguilar.com/posts/candy_crush_difficulty/index.md" target="_blank">Read Markdown</a>
                        </span></div>
        </div><div class="post-info-share">
            <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://robguilar.com/posts/candy_crush_difficulty/" data-title="Leveling Difficulty in Candy Crush Saga" data-via="map[id:robguilarr prefix:https://twitter.com/ title:Twitter weight:1]" data-hashtags="Bernoulli,Python"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://robguilar.com/posts/candy_crush_difficulty/" data-hashtag="Bernoulli"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://robguilar.com/posts/candy_crush_difficulty/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on Pinterest" data-sharer="pinterest" data-url="https://robguilar.com/posts/candy_crush_difficulty/" data-description="From 15 levels of a Candy Crush episode we&#39;ll see how to level the difficulty using Bernoulli principles with Python and Jupyter Notebooks"><i class="fab fa-pinterest fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://robguilar.com/posts/candy_crush_difficulty/"><i class="fab fa-reddit fa-fw"></i></a></span>
        </div></div><div class="post-nav"><a href="https://robguilar.com/posts/ab_testing_cookiecats/" class="prev" rel="prev" title="A/B Testing with Cookie Cats Game"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://robguilar.com/"></a></span>&nbsp;|&nbsp;<span class="license">Hosted on Netlify</span></div>
</div>
<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker
        .register('/sw.min.js?version=1.0.1', { scope: '/' })
        .then(() => {
            console.info('Roberto Aguilar\u00A0Service Worker Registered');
        }, err => console.error('Roberto Aguilar\u00A0Service Worker registration failed: ', err));

    navigator.serviceWorker
        .ready
        .then(() => {
            console.info('Roberto Aguilar\u00A0Service Worker Ready');
        });
}
</script>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.1-beta.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/copy-tex.min.css"><script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script src="https://cdn.jsdelivr.net/npm/object-fit-images@3.2.4/dist/ofi.min.js"></script><script src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.0/dist/autocomplete.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script src="https://cdn.jsdelivr.net/npm/twemoji@13.1.0/dist/twemoji.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.1-beta.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.1/sharer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/mhchem.min.js"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"data":{"id-1":" \u003e robguilar","id-2":" \u003e robguilar"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true,"typeit":{"cursorChar":"|","cursorSpeed":900,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":90}};</script><script src="https://robguilar.com/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-VFQ5L5VZLY');
        </script><script src="https://www.googletagmanager.com/gtag/js?id=G-VFQ5L5VZLY" async></script><script data-goatcounter="https://robguilar.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>
