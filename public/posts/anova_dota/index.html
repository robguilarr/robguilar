<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Assessing the Impact of Patch Releases on Digital Assets in DOTA 2 - Roberto Aguilar</title><meta name="description" content="Inferential analysis with Kruskal–Wallis ANOVA to justify the Balance of Power 6.86 patch logs"><meta property="og:title" content="Assessing the Impact of Patch Releases on Digital Assets in DOTA 2" />
<meta property="og:description" content="Inferential analysis with Kruskal–Wallis ANOVA to justify the Balance of Power 6.86 patch logs" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://robguilar.com/posts/anova_dota/" /><meta property="og:image" content="https://robguilar.com/images/posts/anova_dota.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-24T21:57:40+08:00" />
<meta property="article:modified_time" content="2022-07-24T21:57:40+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://robguilar.com/images/posts/anova_dota.jpg"/>

<meta name="twitter:title" content="Assessing the Impact of Patch Releases on Digital Assets in DOTA 2"/>
<meta name="twitter:description" content="Inferential analysis with Kruskal–Wallis ANOVA to justify the Balance of Power 6.86 patch logs"/>
<meta name="application-name" content="&gt; robguilar">
<meta name="apple-mobile-web-app-title" content="&gt; robguilar"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#525252"><link rel="shortcut icon" type="image/x-icon" href="https://robguilar.com/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="https://robguilar.com/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://robguilar.com/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="https://robguilar.com/apple-touch-icon.png"><link rel="mask-icon" href="https://robguilar.com/safari-pinned-tab.svg" color="#525252"><link rel="manifest" href="https://robguilar.com/site.webmanifest"><link rel="canonical" href="https://robguilar.com/posts/anova_dota/" /><link rel="prev" href="https://robguilar.com/posts/control_mechanics_fallout/" /><link rel="next" href="https://robguilar.com/posts/brawlstars_retention_pipeline/" /><link rel="alternate" href="https://robguilar.com/posts/anova_dota/index.xml" type="application/rss+xml" title="Roberto Aguilar">
    <link rel="feed" href="https://robguilar.com/posts/anova_dota/index.xml" type="application/rss+xml" title="Roberto Aguilar"><link rel="stylesheet" href="https://robguilar.com/css/page.min.css"><link rel="stylesheet" href="https://robguilar.com/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Assessing the Impact of Patch Releases on Digital Assets in DOTA 2",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/robguilar.com\/posts\/anova_dota\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/robguilar.com\/images\/posts\/anova_dota.jpg",
                            "width":  3000 ,
                            "height":  900 
                        }],"genre": "posts","keywords": "Kruskal–Wallis ANOVA, Mann-Whitney t-test, Kolmogorov-Smirnov, Bootstrapping, Python","wordcount":  7629 ,
        "url": "https:\/\/robguilar.com\/posts\/anova_dota\/","datePublished": "2022-07-24T21:57:40+08:00","dateModified": "2022-07-24T21:57:40+08:00","license": "This work is developed and posted only under Roberto's property","publisher": {
            "@type": "Organization",
            "name": "Roberto Aguilar","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/robguilar.com\/images\/logo.png",
                    "width":  1977 ,
                    "height":  2014 
                }},"author": {
                "@type": "Person",
                "name": "Roberto Aguilar"
            },"description": "Inferential analysis with Kruskal–Wallis ANOVA to justify the Balance of Power 6.86 patch logs"
    }
    </script></head><body data-header-desktop="auto" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="https://robguilar.com/" title="Roberto Aguilar"><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="https://robguilar.com/posts/" title="Timeline"> Timeline </a><a class="menu-item" href="https://robguilar.com/categories/" title="Projects"> Projects </a><a class="menu-item" href="https://robguilar.com/tags/" title="Tags"> Tags </a><a class="menu-item" href="https://robguilar.com/about/" title="About"> About </a><a class="menu-item" href="https://github.com/robguilarr/" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i> GitHub </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="https://robguilar.com/" title="Roberto Aguilar"><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="https://robguilar.com/posts/" title="Timeline">Timeline</a><a class="menu-item" href="https://robguilar.com/categories/" title="Projects">Projects</a><a class="menu-item" href="https://robguilar.com/tags/" title="Tags">Tags</a><a class="menu-item" href="https://robguilar.com/about/" title="About">About</a><a class="menu-item" href="https://github.com/robguilarr/" title="" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>GitHub</a><div class="menu-item"><a href="javascript:void(0);" class="theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="enable"><div class="single-card" ><h2 class="single-title animated flipInX">Assessing the Impact of Patch Releases on Digital Assets in DOTA 2</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="https://www.linkedin.com/in/robguilarr/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Roberto Aguilar</a></span>&nbsp;<span class="post-category">published in <a href="https://robguilar.com/categories/projects/"><i class="far fa-folder fa-fw"></i>Projects</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-07-24">2022-07-24</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;7629 words</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;36 minutes</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>Contents</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#-introduction-to-problem">⚠️ Introduction to problem</a>
      <ul>
        <li><a href="#hypothesis">Hypothesis</a></li>
        <li><a href="#potential-stakeholders">Potential Stakeholders</a></li>
      </ul>
    </li>
    <li><a href="#-about-the-data">📥 About the data</a>
      <ul>
        <li><a href="#collection-process-and-structure">Collection process and structure</a></li>
      </ul>
    </li>
    <li><a href="#-data-preprocessing">🔧 Data Preprocessing</a>
      <ul>
        <li><a href="#data-consistency">Data Consistency</a></li>
        <li><a href="#data-distribution-validation">Data Distribution Validation</a></li>
      </ul>
    </li>
    <li><a href="#-exploratory-analysis--in-game-interpretations">🔍 Exploratory Analysis &amp; In-game interpretations</a>
      <ul>
        <li><a href="#-overview-of-metrics-by-lane-roles">🗺️ Overview of Metrics by Lane Roles</a></li>
        <li><a href="#-kills-logs-comparison-grouped-by-role-and-hero">☠️ Kills logs comparison grouped by Role and Hero</a></li>
        <li><a href="#-two-sample-mann-whitney-test-for-kills-logs-by-role-lane-for-carries">🧝🏻‍♂️ Two Sample Mann-Whitney Test for Kills logs by Role Lane for Carries</a></li>
        <li><a href="#-two-sample-mann-whitney-test-for-kills-of-mid-lanes-and-soft-support-vs-rest-of-roles">🧝🏻👹 Two Sample Mann-Whitney Test for Kills of Mid Lanes and Soft Support vs Rest of Roles</a></li>
        <li><a href="#-kruskalwallis-one-way-anova">🧙‍♂️ Kruskal–Wallis One-Way ANOVA</a></li>
      </ul>
    </li>
    <li><a href="#-final-thoughts--takeaways">🗒️ Final thoughts &amp; takeaways</a></li>
    <li><a href="#ℹ-additional-information">ℹ️ Additional Information</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><p><strong>Abstract</strong>: This study examines the effect of a game patch on hero balance in Multiplayer Online Battle Arena (MOBA) games, focusing on changes in hero damage output. Utilizing ANOVA tests and statistical analyses, including Kruskal–Wallis ANOVA, Mann-Whitney U test, Kolmogorov-Smirnov test, and Bootstrapping in Python, data from ranked matchmaking sessions were analyzed to assess the statistical significance of damage output changes according to the official <a href="https://www.dota2.com/patches/7.31d" target="_blank" rel="noopener noreffer">changelog</a>. Findings reveal Shadow Fiend as the standout hero with increased gold collection, tower damage, and victories due to the ‘Requiem of Souls’ ability&rsquo;s enhancement with the &ldquo;Aghanim’s Scepter&rdquo; in patch 6.86. In contrast, Zeus was identified as having the highest damage output, attributed to a character remodel, its role as Soft Support, and its straightforward playability. The study offers insights into the implications of game patches on hero performance, providing a foundation for further game design and balance discussions.</p>
<hr>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>Looking for an interactive experience?<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">🚀 Download the Jupyter Notebook, available <a href="https://github.com/robguilarr/anova_dota/blob/master/notebook.ipynb">here</a></div>
        </div>
    </div>

<div class="video">
  <iframe src="https://www.youtube.com/embed/-cSFPIwMEq4" allow="fullscreen" title="YouTube Video"></iframe>
</div>

<h2 id="-introduction-to-problem">⚠️ Introduction to problem</h2>
<h3 id="hypothesis">Hypothesis</h3>
<p>For online multiplayers, sustainability mirrors the voice of customers. In the case of DOTA, the platform&rsquo;s exclusivity due to the ownership of its developer, <a href="https://www.valvesoftware.com/en/about" target="_blank" rel="noopener noreffer">Valve Corporation</a>, make it more reachable to gather community reviews on time from the Steam store. This, in comparison to other games' developers, who might require to access an endpoint to connect to <a href="https://partner.steamgames.com/doc/store/getreviews" target="_blank" rel="noopener noreffer">Steamworks API</a> to perform the same task.</p>
<p>The Consumer Insights team at Valve gathered all the internal reviews and external’s from social networks of high traffic in this niche, like Reddit. After an exhaustive NLP analysis, the team has found that players tend to comment about <a href="https://en.wikipedia.org/wiki/Game_balance#Buff_and_nerf" target="_blank" rel="noopener noreffer">Nerfing and Buffing</a> heroes, which is very common in MOBA games when every patch is released. And, since patch 6.86 was released on December 16 of 2015, also known as <a href="https://www.dota2.com/balanceofpower" target="_blank" rel="noopener noreffer">Balance of Power</a>, the team has found many comments about this topic, so they require to generate actionable insights to let the Game Designers take action on time.</p>
<p>After carefully collecting player logs since the released date of this patch, they need to test if effectively the heroes’ stats are unbalanced or not. As the main interaction between enemy players is measured by the damage dealt, this will be defined as the core KPI of this study and with this, we will define our hypothesis as:</p>
<ul>
<li>
<p>$H_0:$ After the release date of patch 6.86, the heroes <strong>have recorded</strong> a statistically equal damage.</p>
</li>
<li>
<p>$H_1:$ After the release date of patch 6.86, the heroes <strong>haven’t recorded</strong> a statistically equal damage.</p>
</li>
</ul>
<figure><a class="lightgallery" href="https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png" title="https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png" data-thumbnail="https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png" data-sub-html="<h2>Designed by Roberto Aguilar, 2022</h2>">
        <img
            class="lazyload"
            src="https://robguilar.com/svg/loading.min.svg"
            data-src="https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png"
            data-srcset="https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png, https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png 1.5x, https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png 2x"
            data-sizes="auto"
            alt="https://raw.githubusercontent.com/robguilarr/robguilar-website/main/content/posts/anova_dota/images/asset_01.png" width="1050px" />
    </a><figcaption class="image-caption">Designed by Roberto Aguilar, 2022</figcaption>
    </figure>
<h3 id="potential-stakeholders">Potential Stakeholders</h3>
<ul>
<li>
<p>Level Designers: if the heroes are balanced in terms of damage, the damage dealt by the creeps will require an investigation, which depends on the design of the map lanes. They must hit a balance between creating easy or hard experiences, and this will rely on the creeps per lane. Another mapping issue that would need to address is the jungle, which is typically filled with <a href="https://dota2.fandom.com/wiki/Creeps" target="_blank" rel="noopener noreffer">creeps</a> that players can kill for <a href="https://dota2.fandom.com/wiki/Jungling#" target="_blank" rel="noopener noreffer">rewards</a>, which the designers require to define how challenging they should be to defeat.</p>
</li>
<li>
<p>Character Designer and Engineers: they evaluate the design of the heroes to be certain that each team is balanced, and confirm there is no side having an unfair benefit. In such cases will have to rebalance the hero stats with the help of the Gameplay Engineer, and adjust the HUD with the help of a Systems Engineer.</p>
</li>
<li>
<p>User Retention team: by working around the Data Analysts, they will support delivering the final report to the Lead Game Designer, about the potential effect on the players' retention in case of not taking quick actions, in the scenario of having a true Null Hypothesis.</p>
</li>
<li>
<p>PR team and Community Manager: they must be aligned to deliver an accurate <a href="https://www.dota2.com/news/updates" target="_blank" rel="noopener noreffer">Patch note</a> with an accurate summary of the next patch to be released.</p>
</li>
<li>
<p>Players community: as the main stakeholder, the core sustainability of this IP comes from the community engagement, so they expect to have a more balanced experience at least for patch 6.86b.</p>
</li>
</ul>
<p><strong>Note:</strong> To facilitate the understanding of the roles of the development team, I invite you to take a look at <strong><a href="https://www.robguilar.com/posts/gamedev_structure/" target="_blank" rel="noopener noreffer">this</a></strong> <a href="https://miro.com/app/board/uXjVOwQVsRk=/?share_link_id=215280076044" target="_blank" rel="noopener noreffer"></a>diagram that I designed.</p>
<h2 id="-about-the-data">📥 About the data</h2>
<p>This dataset was collected on December 17th of 2015 from a sample of <a href="https://dota2.fandom.com/wiki/Matchmaking#Ranked_Match" target="_blank" rel="noopener noreffer">Ranked Matchmaking</a> mode, which holds information from 49,855 different contests, where 149,557 different players formed part of them.</p>
<p>As we mentioned in the <a href="https://github.com/robguilarr/anova_dota/blob/master/preprocess.ipynb" target="_blank" rel="noopener noreffer">preprocessing notebook</a>, the raw extracted data can be found in the <a href="https://academictorrents.com/details/5c5deeb6cfe1c944044367d2e7465fd8bd2f4acf" target="_blank" rel="noopener noreffer">YASP.CO</a> collection from Academic Torrents. This dataset was uploaded and gathered by <a href="https://academictorrents.com/browse.php?search=Albert&#43;Cui" target="_blank" rel="noopener noreffer">Albert Cui</a> et. al (2015). However, you can extract your sample from the <a href="https://www.opendota.com/explorer" target="_blank" rel="noopener noreffer">OpenDota API</a> query interface for the comfort of use.</p>
<h3 id="collection-process-and-structure">Collection process and structure</h3>
<p>According to Albert Cui et. al (2014), OpenDota is a volunteer-developed, open-source service to request DOTA 2 semistructured data gathered from the Steam WebAPI, which has the advantage of retrieving a vast amount of replay files in comparison to the source API. The service also provides a web interface for casual users to browse through the collected data, as well as an API to allow developers to build their applications with it.</p>
<p>The present sample can be found in an archive of <a href="https://academictorrents.com/details/5c5deeb6cfe1c944044367d2e7465fd8bd2f4acf" target="_blank" rel="noopener noreffer">YASP.CO</a>, which was uploaded for the same developers of the OpenDota project, <a href="https://github.com/albertcui" target="_blank" rel="noopener noreffer">Albert Cui</a>, <a href="https://github.com/howardchung" target="_blank" rel="noopener noreffer">Howard Chung</a>, and <a href="https://github.com/nicholashh" target="_blank" rel="noopener noreffer">Nicholas Hanson-Holtry</a>. Due to the size of the data (99 GB), we won&rsquo;t find the raw data in the Github repository of this project, however, you will find a random sample with its respective preprocessing explanation in a Jupyter Notebook.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<p>As a suggestion, to preprocess data of this size, the most accurate solution is to use parallel computing frameworks like Apache Spark to do the transformations. Web services like Databricks with its Lakehouse Architecture, let us process semi-structured data with the capabilities of a Data Warehouse and the flexibility of a Data Lake, and to do this you can use the Data Science and Engineering environment of the <a href="https://community.cloud.databricks.com/login.html" target="_blank" rel="noopener noreffer">Community Edition</a> for free.</p>
<p>Without diving deeper, let&rsquo;s import the initially needed packages and the preprocessed data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Basic packages</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">floor</span>

<span class="c1"># Plotly packages</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="c1"># Plotly static config</span>
<span class="n">static</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;staticPlot&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

<span class="c1"># Own package for layout of plots</span>
<span class="kn">from</span> <span class="nn">vizformatter.standards</span> <span class="kn">import</span> <span class="n">layout_plotly</span>

<span class="c1"># Load layout base objects</span>
<span class="n">sign</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">720</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Import preprocessed data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;DOTA_data/data.csv&#34;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;N/A&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="s2">&#34;nan&#34;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p align="left"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/table_1.jpg" style="width: 1050px"></p>
<p>As we can notice, in our data we have a total of 28 attributes, however, not all of them will be used in this study but for future investigations of extra user metrics, we see that all the assembled data could be a useful asset. In such case you require the description of one of these attributes, please guide yourself with the <strong>Appendix</strong> at the end of the <a href="https://github.com/robguilarr/anova_dota/blob/master/preprocess.ipynb" target="_blank" rel="noopener noreffer">preprocess notebook</a>, where you will find a punctual explanation.</p>
<h2 id="-data-preprocessing">🔧 Data Preprocessing</h2>
<p>Almost every transformation was made on the preprocessing notebook, there you will encounter different blocs like the joins of hero descriptions, items used per session, and match outcomes to the main table of players' registries. In the end, also will be a distribution study, to exclude outliers based on irregularities recorded on sessions (impossible values). Knowing this, we can say that the data is ready to go, so we can skip the Data Cleaning section. Here we are going to do an overall inspection.</p>
<h3 id="data-consistency">Data Consistency</h3>
<p>Considering conceivable errors in the telemetry logs, we require to validate the lack of missing values on each one of the features.</p>
<p>One of the attributes that required a substantial transformation to infer and extract descriptive values for each player was the “player_slot”, which is no more in the present dataset. This value was an 8-bit unsigned integer, where the first digit defined the faction (Radiant | Dire), the next four digits were empty and the last three defined the lane role of the player within the team. The encoding is part of the reason why there were present some missing data that wasn’t describing the record.</p>
<p>After the pruning was executed, the sample remain significant in size with 290,000 records, and by the next table, we can verify it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">nullCounter</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># Create empty lists</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nulls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">total_rows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
        <span class="c1"># Null values</span>
        <span class="n">null_counter</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="c1"># Append only columns with null values</span>
        <span class="k">if</span> <span class="n">null_counter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Append values to lists</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">nulls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">null_counter</span><span class="p">)</span>

            <span class="c1"># Generate percentage</span>
            <span class="n">perc_value</span> <span class="o">=</span> <span class="n">null_counter</span><span class="o">/</span><span class="n">total_rows</span>
            <span class="n">perc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">{:.2%}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">perc_value</span><span class="p">))</span>

    <span class="c1"># Create DF from lists</span>
    <span class="n">nullsTable</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Null Values&#39;</span><span class="p">:</span><span class="n">nulls</span><span class="p">,</span> <span class="s1">&#39;Fraction&#39;</span><span class="p">:</span><span class="n">perc</span><span class="p">})</span><span class="o">.</span><span class="n">T</span>
    <span class="n">nullsTable</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>

    <span class="k">return</span> <span class="n">nullsTable</span>

<span class="n">nullCounter</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">data</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="left"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/table_2.jpg" style="width: 700px"></p>
<p>The columns with more NA values are the ones relative to the player position. In case of any comparison needed in terms of lane position, we will take another sample ensuring that we have a significant size to run our tests.</p>
<h3 id="data-distribution-validation">Data Distribution Validation</h3>
<p>Every column is already transformed into its respective data type, and depending on the analysis needed we should require to retransform it or even apply a linear scaling method to be interpreted.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span> <span class="p">[</span><span class="s2">&#34;number&#34;</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><p align="left"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/table_3.jpg" style="width: 1050px"></p>
<p>We can see each value defined by the percentiles, however, is preferable to have a straightforward vision to conclude about each feature.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Load a new layout for grid axis</span>
<span class="n">signGrid</span><span class="p">,</span> <span class="n">layoutGrid</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">900</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Function to generate grid of boxplots</span>
<span class="k">def</span> <span class="nf">gridDist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">sign</span><span class="p">):</span>
    <span class="c1"># Validate not using ids in the grid</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_id&#39;</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="s1">&#39;id&#39;</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Extract columns with numeric values</span>
    <span class="n">numerics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;int16&#39;</span><span class="p">,</span> <span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float16&#39;</span><span class="p">,</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">numerics</span><span class="p">)</span>

    <span class="c1"># Calculate grid space, for columns and rows in the layout</span>
    <span class="n">num_col</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_col</span><span class="p">))</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cols</span>

    <span class="c1"># Generate subplots grid</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

    <span class="c1"># Populating spaces with Graphic objects</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">rows</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cols</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">column_name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span>
                <span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span> <span class="n">column_name</span><span class="p">)</span>
                <span class="n">grid</span><span class="o">.</span><span class="n">append_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="n">num_col</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">counter</span> <span class="o">+=</span><span class="mi">1</span>

    <span class="c1"># Adding layout conf</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>

    <span class="c1"># Disable interactivity by transforming image to bytes</span>
    <span class="n">static</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;staticPlot&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">static</span><span class="p">)</span>

<span class="n">gridDist</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span> <span class="n">layoutGrid</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span> <span class="n">signGrid</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_1.png" style="width: 1050px"></p>
<p>From the dispersal of each attribute, we can notice that most of the data is right-skewed. We don&rsquo;t have any information bonded to system anomalies during data collection, so from the variables that we are going to use in our analysis, we can notice descriptive behaviors like:</p>
<ul>
<li>
<p>Per session players usually report, on average, a total of 11 assists and 6 kills with a median hero damage score of 10,500.</p>
</li>
<li>
<p>There is a big segment of outliers from players who healed allies, with a value of over 233 points. Making general assumptions over its distribution wouldn&rsquo;t be accurate, because that segment could be linked with the Hard Support role.</p>
</li>
<li>
<p>The same situation happens with the gold collected and the tower damage, where there is a great number of scores above the 75% percentile, which can be due to lane role differences like Soft Support which is usually a role used for <a href="https://dota2.fandom.com/wiki/Jungling#" target="_blank" rel="noopener noreffer">Jungling</a>.</p>
</li>
</ul>
<p>In our exploratory analysis, we will have to study these metrics by lane, because each lane has different roles, and some aren&rsquo;t directly comparable. Nevertheless, that&rsquo;s also something that we&rsquo;ll need to demonstrate with a hypothesis test between lanes.</p>
<h2 id="-exploratory-analysis--in-game-interpretations">🔍 Exploratory Analysis &amp; In-game interpretations</h2>
<p>Before going through the hypothesis test, let’s explore the behavior within the categorical variables to check the consistency within the descriptive attributes for the players on each lane.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span> <span class="p">[</span><span class="s2">&#34;object&#34;</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><p align="left"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/table_4.jpg" style="width: 900px"></p>
<p>At first sight, the most common role in our data corresponds to the Offlaner and the most used hero is Windranger, and this makes sense since is one of the heroes with a higher Win Rate on the Offlaner role according to <a href="https://www.dotabuff.com/heroes/windranger" target="_blank" rel="noopener noreffer">DOTABUFF</a>. Also, the two most used shop items are the <a href="https://dota2.fandom.com/wiki/Town_Portal_Scroll" target="_blank" rel="noopener noreffer">Town Portal Scroll</a> and the <a href="https://dota2.fandom.com/wiki/Blink_Dagger" target="_blank" rel="noopener noreffer">Blink Dagger</a>.</p>
<p>But since we have numerous combinations between heroes and items, this might not be the most accurate way to make inferences. So let&rsquo;s look at the combinations for the Radiant and Dire factions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Get combination of items and heroes</span>
<span class="k">def</span> <span class="nf">combItemHero</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">side</span><span class="p">):</span>
    <span class="c1"># Subset Faction/Side</span>
    <span class="n">data</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">side</span> <span class="o">==</span> <span class="n">side</span><span class="p">]</span>
    <span class="c1"># Subset categorical variables</span>
    <span class="n">itemHero</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&#34;object&#34;</span><span class="p">)</span>
    <span class="c1"># Exclude unused columns</span>
    <span class="n">itemHero</span> <span class="o">=</span> <span class="n">itemHero</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="o">~</span><span class="n">itemHero</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;lane&#39;</span><span class="p">,</span><span class="s1">&#39;role&#39;</span><span class="p">,</span><span class="s1">&#39;side&#39;</span><span class="p">])]</span>
    <span class="c1"># Pivot Table</span>
    <span class="n">itemHero</span> <span class="o">=</span> <span class="n">itemHero</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&#34;hero_name&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="c1"># Add counter</span>
    <span class="n">itemHero</span><span class="p">[</span><span class="s1">&#39;counter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">itemHero</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># Drop items column</span>
    <span class="n">itemHero</span> <span class="o">=</span> <span class="n">itemHero</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span> <span class="p">[</span><span class="s2">&#34;level_1&#34;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Rename columns</span>
    <span class="n">itemHero</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hero_name&#39;</span><span class="p">,</span><span class="s1">&#39;item&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
    <span class="c1"># Get combinations DF</span>
    <span class="n">itemHero</span> <span class="o">=</span> <span class="n">itemHero</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;hero_name&#39;</span><span class="p">,</span><span class="s1">&#39;item&#39;</span><span class="p">])[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Create combination column</span>
    <span class="n">itemHero</span><span class="p">[</span><span class="s1">&#39;stage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">itemHero</span><span class="o">.</span><span class="n">hero_name</span> <span class="o">+</span> <span class="s1">&#39; with &#39;</span> <span class="o">+</span> <span class="n">itemHero</span><span class="o">.</span><span class="n">item</span>
    <span class="c1"># Reorder columns</span>
    <span class="n">itemHero</span> <span class="o">=</span> <span class="n">itemHero</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">itemHero</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hero_name&#39;</span><span class="p">,</span><span class="s1">&#39;item&#39;</span><span class="p">])</span>
    <span class="c1"># Add side column</span>
    <span class="n">itemHero</span><span class="p">[</span><span class="s1">&#39;side&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">side</span>

    <span class="k">return</span> <span class="n">itemHero</span>

<span class="c1"># Drop empty hero names</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">hero_name</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span>

<span class="c1"># Set new dataframes</span>
<span class="n">itemHeroRad</span><span class="o">=</span> <span class="n">combItemHero</span><span class="p">(</span><span class="n">df</span><span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span> <span class="s1">&#39;Radiant&#39;</span><span class="p">)</span>
<span class="n">itemHeroDire</span><span class="o">=</span> <span class="n">combItemHero</span><span class="p">(</span><span class="n">df</span><span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span> <span class="s1">&#39;Dire&#39;</span><span class="p">)</span>
<span class="c1"># Concatenate dataframes</span>
<span class="n">allItemHero</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">itemHeroRad</span><span class="p">,</span> <span class="n">itemHeroDire</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># Generate Visuals</span>
<span class="n">allItemHero</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">funnel</span><span class="p">(</span><span class="n">allItemHero</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;stage&#39;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;side&#39;</span><span class="p">,</span> <span class="n">color_discrete_sequence</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#E25822&#39;</span><span class="p">,</span><span class="s1">&#39;#2C538F&#39;</span><span class="p">])</span>
<span class="n">allItemHero</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">allItemHero</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="s1">&#39;Combinations recorded of Hero and Items from 50K sessions&#39;</span><span class="p">},</span>
                            <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&#34;Combinations&#34;</span><span class="p">)</span>
<span class="n">allItemHero</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">allItemHero</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_2.png" style="width: 1000px"></p>
<p>Now we can verify the initial statement that the Windranger is the most played hero, but at the same time, we can check that the Town Portal Scroll and the Blink Dagger are not the most used for this hero, meaning that their use is because of commonness and not because it&rsquo;s a good fit for that hero.</p>
<ul>
<li>
<p><strong>Windranger</strong> it&rsquo;s a ranged hero that can buff her stats by 3.75% in <a href="https://dota2.fandom.com/wiki/Movement_speed" target="_blank" rel="noopener noreffer">movement speed</a>. According to <a href="https://dotesports.com/news/how-to-play-windranger-like-liquid-w33" target="_blank" rel="noopener noreffer">Tan Guan</a>, these boots supply the most damage out of any boots choice, and the six armor allows an Intelligence hero to have a mana-less option to chase the enemy down. Also, the Phase active brings you up to max movement speed with Windrun (another physical ability for movement speed).</p>
</li>
<li>
<p>The same case is for <strong>Shadow Fiend</strong> using Power Treads, where some advanced strategies are possible for players who like to micromanage or wish to maximize their efficiency in a competitive setting. Like switching the Power Treads to Intelligence before a fight to allow this hero to cast one more spell.</p>
</li>
</ul>
<p>While examining patches, it&rsquo;s always important to examine the performance of the character by sampling the player statistics. In such case of DOTA, it would let the designers decide which heroes need to be nerfed and which need to be buffed, by delivering changes in a patch log attached to the bottom side of the <a href="https://www.dota2.com/balanceofpower" target="_blank" rel="noopener noreffer">documentation website</a>. To put you in context, <strong>nerfed</strong> means a negative effect on the hero&rsquo;s stats, while <strong>buffed</strong> means the opposite, given an update (patch) on the game.</p>
<h3 id="-overview-of-metrics-by-lane-roles">🗺️ Overview of Metrics by Lane Roles</h3>
<p>We saw that generalizing about all the heroes and extracting insights, it’s not the best way to produce findings, because many times the perspective can bias our interpretations, especially while dealing with Big Data.</p>
<p>As we move on to the next analysis, the main intent is to narrow down our scope of analysis (data sample), so to start let’s compare the core metrics by role lane.</p>
<p>First, let’s see the scores for how much a player heals their allies' heroes, how much the player damages the enemys' heroes, and how many times each player dies on average, taking as a group the role assigned in the lane.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Function to scale variables using &#34;Linear Scaling&#34;</span>
<span class="k">def</span> <span class="nf">linearScale</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">scaled</span> <span class="o">=</span> <span class="p">(</span><span class="n">array</span> <span class="o">-</span> <span class="n">array</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">array</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">scaled</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">scaled</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scaled</span>

<span class="c1"># Subset required columns</span>
<span class="n">dataHeal</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;role&#39;</span><span class="p">,</span><span class="s1">&#39;deaths&#39;</span><span class="p">,</span><span class="s1">&#39;hero_healing&#39;</span><span class="p">,</span><span class="s1">&#39;hero_damage&#39;</span><span class="p">])]</span>

<span class="c1"># Reorder columns</span>
<span class="n">dataHeal</span> <span class="o">=</span> <span class="n">dataHeal</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>

<span class="c1"># Extract only the subset of players that healed during session</span>
<span class="n">dataHeal</span> <span class="o">=</span> <span class="n">dataHeal</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Load a new layout for parallel axis</span>
<span class="n">signPar</span><span class="p">,</span> <span class="n">layoutPar</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1500</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>

<span class="c1"># Generate Parallel Coordinates plot</span>
<span class="n">parallel</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Parcoords</span><span class="p">(</span>
        <span class="n">line</span><span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
               <span class="n">colorscale</span><span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;#3BE8B0&#39;</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="s1">&#39;#1AAFD0&#39;</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;#6A67CE&#39;</span><span class="p">],[</span><span class="mf">0.75</span><span class="p">,</span><span class="s1">&#39;#FFB900&#39;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;#FC636B&#39;</span><span class="p">]]),</span>
        <span class="n">dimensions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span>
            <span class="nb">dict</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">role</span><span class="p">)],</span>
                 <span class="n">tickvals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                 <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                 <span class="n">ticktext</span> <span class="o">=</span> <span class="n">dataHeal</span><span class="o">.</span><span class="n">role</span><span class="p">),</span>
            <span class="nb">dict</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">hero_healing</span><span class="p">)),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">hero_healing</span><span class="p">))],</span>
                 <span class="c1">#tickvals = [0,0.25,0.5,0.75,1],</span>
                 <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Healing&#39;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">dataHeal</span><span class="o">.</span><span class="n">hero_healing</span><span class="p">),</span>
            <span class="nb">dict</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">hero_damage</span><span class="p">)),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">hero_damage</span><span class="p">))],</span>
                 <span class="c1">#tickvals = [0,0.25,0.5,0.75,1],</span>
                 <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Damage&#39;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">dataHeal</span><span class="o">.</span><span class="n">hero_damage</span><span class="p">),</span>
            <span class="nb">dict</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">linearScale</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">deaths</span><span class="p">))),</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">linearScale</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">deaths</span><span class="p">)))],</span>
                 <span class="c1">#tickvals = [0,0.25,0.5,0.75,1],</span>
                 <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Scaled Deaths&#39;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">linearScale</span><span class="p">(</span><span class="n">dataHeal</span><span class="o">.</span><span class="n">deaths</span><span class="p">))</span>
        <span class="p">])</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Assign layout for parallel axis</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layoutPar</span><span class="p">)</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;t&#34;</span><span class="p">:</span> <span class="mi">125</span><span class="p">,</span>
                        <span class="s2">&#34;l&#34;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="s2">&#34;User Metrics comparison by Role Lane&#34;</span><span class="p">})</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">signPar</span><span class="p">)</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_3.png" style="width: 1500px"></p>
<p>From the last visual we can drag the next insights:</p>
<ul>
<li>
<p><strong>Soft support</strong> is the role where they dedicate less effort to healing their teammates (due to their freedom is the role used for Jungling), while <strong>Midlaners</strong> dedicate more time to healing teammates. This is probably due to their high mobility during the session, and because they have the major responsibility to be the team&rsquo;s playmakers, according to Zach the DOTA <a href="https://www.patreon.com/ZQuixotix" target="_blank" rel="noopener noreffer">coach</a>.</p>
</li>
<li>
<p>In terms of Damage dealt, we can say that by far Soft Support and Midlaners are the positions that dealt more damage, while <strong>Hard Carry</strong> is the opposite because they require a clear vision of the momentum between staying in the Safelane with the Hard Support or moving through the Offlane to attack enemy buildings.</p>
</li>
<li>
<p>As being a <strong>Hard Support</strong> is the less complex role to start, heal more, and damage less. According to Zach the DOTA <a href="https://www.patreon.com/ZQuixotix" target="_blank" rel="noopener noreffer">coach</a>, they need to farm a little and be actively healing their teammates. At the same time, they need to know where to be positioned, cause if one core is farming a lot, you will need to be actively doing the same; if one core is always in action they need to be healing.</p>
</li>
</ul>
<p>We saw that Soft Support and the Midlaners have a very similar average of Damage Dealt per session, so we can analyze by checking the Kills logs by hero.</p>
<h3 id="-kills-logs-comparison-grouped-by-role-and-hero">☠️ Kills logs comparison grouped by Role and Hero</h3>
<p>The core interaction between enemy players is measured by Kills. We&rsquo;ll compare the logs by groups; one being grouped by Role and another by Hero, keeping in mind that the main intent is to discover the more buffed heroes since the release of the last patch.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Function to aggregate variables by group</span>
<span class="k">def</span> <span class="nf">groupGen</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">grouper</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">top</span><span class="p">):</span>
    <span class="c1"># Aggregate new dataframe</span>
    <span class="n">dataCoord</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">grouper</span><span class="p">,</span><span class="n">variable</span><span class="p">]]</span>
    <span class="n">dataCoord</span> <span class="o">=</span> <span class="n">dataCoord</span><span class="p">[</span><span class="n">dataCoord</span><span class="p">[</span><span class="n">grouper</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span>
    <span class="n">dataCoord</span> <span class="o">=</span> <span class="n">dataCoord</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouper</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="c1"># Normalize the data with Linear Scaling</span>
    <span class="n">dataCoord</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">linearScale</span><span class="p">(</span><span class="n">dataCoord</span><span class="p">[</span><span class="n">variable</span><span class="p">])</span>
    <span class="c1"># Resort DF randomly</span>
    <span class="n">dataCoord</span> <span class="o">=</span> <span class="n">dataCoord</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span> <span class="n">variable</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
    <span class="n">dataCoord</span> <span class="o">=</span> <span class="n">dataCoord</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dataCoord</span>

<span class="c1"># Generate aggregated data for heros and roles</span>
<span class="n">heroGroup</span> <span class="o">=</span> <span class="n">groupGen</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">grouper</span><span class="o">=</span> <span class="s1">&#39;hero_name&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span> <span class="s1">&#39;kills&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">roleGroup</span> <span class="o">=</span> <span class="n">groupGen</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">grouper</span><span class="o">=</span> <span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span> <span class="s1">&#39;kills&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Load a new layout for polar axis</span>
<span class="n">signPolar</span><span class="p">,</span> <span class="n">layoutPolar</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1750</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">13</span><span class="p">)</span>

<span class="c1"># Create subplot layout, with 2 subplots of polar type</span>
<span class="n">polars</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="p">[[{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;polar&#39;</span><span class="p">}]</span><span class="o">*</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Add subplot graphic objects</span>
<span class="n">polars</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Kills by role&#34;</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">roleGroup</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">roleGroup</span><span class="o">.</span><span class="n">role</span><span class="p">,</span> <span class="n">line_color</span> <span class="o">=</span> <span class="s2">&#34;#007fff&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">),</span> 
                            <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;toself&#39;</span><span class="p">)</span>
<span class="n">polars</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Barpolar</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Kills by hero&#34;</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">heroGroup</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">heroGroup</span><span class="o">.</span><span class="n">hero_name</span><span class="p">),</span>
                           <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Add layout format</span>
<span class="n">polars</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&#34;plotly_dark&#34;</span><span class="p">)</span>
<span class="n">polars</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layoutPolar</span><span class="p">)</span>
<span class="n">polars</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="s2">&#34;Linearly scaled kills log by role and hero&#34;</span><span class="p">})</span>
<span class="n">polars</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">signPolar</span><span class="p">)</span>
<span class="n">polars</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_4.png" style="width: 1500px"></p>
<p>In terms of kills, we can justify these stats by looking at the updates given in the changelogs of patch 6.86:</p>
<ul>
<li>
<p><a href="https://dota2.fandom.com/wiki/Riki/Changelogs" target="_blank" rel="noopener noreffer">Riki</a>: since this hero was introduced with the new &lsquo;Cloak and Dagger&rsquo; ability, he can become invisible each time attacks an enemy from behind, which is a perfect combination with ‘Blink Strike’ which was transformed into basic agility. This second gives the user bonus damage for attacks from behind and also does a quick teleport to the enemy&rsquo;s back, giving more to use this combination.</p>
</li>
<li>
<p><a href="https://dota2.fandom.com/wiki/Huskar/Changelogs" target="_blank" rel="noopener noreffer">Huskar</a>: This hero received a hard magic resistance and attack bonus speed mechanical change with bonus changes from 5% to 50%.</p>
</li>
<li>
<p><a href="https://dota2.fandom.com/wiki/Ursa/Changelogs" target="_blank" rel="noopener noreffer">Ursa</a>: known as one of the heroes most used to Jungling, in this patch the &lsquo;Aghanim&rsquo;s Scepter&rsquo; was added to this hero which also let him cast the ‘Enrage’ ability while being stunned, slept, taunted, hidden, or during forced movement. The main use of ‘Enrage’ is to reduce the income damage by ~80%.</p>
</li>
</ul>
<p>Midlaner and Soft Support are the roles with more kills registered, which are the 2 positions in which Riki, Huskar, Ursa, and Queen of Pain are used because they are in the <a href="https://dota2.fandom.com/wiki/Category:Carries#" target="_blank" rel="noopener noreffer">Carry</a> heroes category.</p>
<p>From the last global perspective of heroes and lanes, the purpose of the analysis is to let it evolve as granular as possible to handle detailed deductions, so let&rsquo;s compare the Soft Support and Midlaner roles to decide on which to concentrate our study.</p>
<h3 id="-two-sample-mann-whitney-test-for-kills-logs-by-role-lane-for-carries">🧝🏻‍♂️ Two Sample Mann-Whitney Test for Kills logs by Role Lane for Carries</h3>
<p>We still doubt which of the two roles is the one preferred to use Carry heroes, in other words, those that are used to rank up by logging as many kills as possible.</p>
<p>To do this we can run a two-sample t-test, so first let&rsquo;s check the normality since this is a must-have assumption.</p>
<p>It&rsquo;s important to mention that to respect the <a href="https://en.wikipedia.org/wiki/Independence_%28probability_theory%29" target="_blank" rel="noopener noreffer">independence</a> assumption, in the last code we extracted one record per player from a random <strong>resampled without replacement</strong> data frame. This is in case the player count with multiple sessions logged. For this test, we prefer to have a randomized sample where the groups are <strong>mutually exclusive</strong>, so a player can only belong to one role group.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Normality check function</span>
<span class="k">def</span> <span class="nf">normality_two_sample</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
    <span class="n">stat_1</span><span class="p">,</span> <span class="n">p_1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
    <span class="n">stat_2</span><span class="p">,</span> <span class="n">p_2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

    <span class="c1"># Validate p_value</span>
    <span class="k">if</span> <span class="n">p_1</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p_2</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;At least one sample is not normal,</span><span class="se">\n</span><span class="s1">where &#39;</span>
            <span class="s1">&#39;the p values are: </span><span class="si">{p_1:.6f}</span><span class="s1"> and </span><span class="si">{p_2:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_1</span><span class="o">=</span> <span class="n">p_1</span><span class="p">,</span><span class="n">p_2</span><span class="o">=</span> <span class="n">p_2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Only Soft_Support sample is normal,</span><span class="se">\n</span><span class="s1">where &#39;</span>
            <span class="s1">&#39;the p values are: </span><span class="si">{p_1:.6f}</span><span class="s1"> and </span><span class="si">{p_2:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_1</span><span class="o">=</span> <span class="n">p_1</span><span class="p">,</span><span class="n">p_2</span><span class="o">=</span> <span class="n">p_2</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p_2</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Only Mid sample is normal,</span><span class="se">\n</span><span class="s1">where &#39;</span>
            <span class="s1">&#39;the p values are: </span><span class="si">{p_1:.6f}</span><span class="s1"> and </span><span class="si">{p_2:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_1</span><span class="o">=</span> <span class="n">p_1</span><span class="p">,</span><span class="n">p_2</span><span class="o">=</span> <span class="n">p_2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;At least one sample is not normal,</span><span class="se">\n</span><span class="s1">where &#39;</span>
            <span class="s1">&#39;the p values are: </span><span class="si">{p_1:.6f}</span><span class="s1"> and </span><span class="si">{p_2:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_1</span><span class="o">=</span> <span class="n">p_1</span><span class="p">,</span><span class="n">p_2</span><span class="o">=</span> <span class="n">p_2</span><span class="p">))</span>

<span class="c1"># List of heroes for Carry role</span>
<span class="n">carries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Shadow_Fiend&#39;</span><span class="p">,</span> <span class="s1">&#39;Ember_Spirit&#39;</span><span class="p">,</span> <span class="s1">&#39;Alchemist&#39;</span><span class="p">,</span> <span class="s1">&#39;Meepo&#39;</span><span class="p">,</span> <span class="s1">&#39;Queen_of_Pain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Windranger&#39;</span><span class="p">,</span> <span class="s1">&#39;Spectre&#39;</span><span class="p">,</span> <span class="s1">&#39;Terrorblade&#39;</span><span class="p">,</span> <span class="s1">&#39;Faceless_Void&#39;</span><span class="p">,</span> <span class="s1">&#39;Brewmaster&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Viper&#39;</span><span class="p">,</span> <span class="s1">&#39;Doom&#39;</span><span class="p">,</span> <span class="s1">&#39;Spirit_Breaker&#39;</span><span class="p">,</span> <span class="s1">&#39;Slardar&#39;</span><span class="p">,</span> <span class="s1">&#39;Juggernaut&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Phantom_Assassin&#39;</span><span class="p">,</span> <span class="s1">&#39;Slark&#39;</span><span class="p">,</span> <span class="s1">&#39;Templar_Assassin&#39;</span><span class="p">,</span> <span class="s1">&#39;Necrophos&#39;</span><span class="p">,</span> <span class="s1">&#39;Invoker&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Luna&#39;</span><span class="p">,</span> <span class="s1">&#39;Tidehunter&#39;</span><span class="p">,</span> <span class="s1">&#39;Gyrocopter&#39;</span><span class="p">,</span> <span class="s1">&#39;Clinkz&#39;</span><span class="p">,</span> <span class="s1">&#39;Silencer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sven&#39;</span><span class="p">,</span> <span class="s1">&#39;Lina&#39;</span><span class="p">,</span> <span class="s1">&#39;Drow_Ranger&#39;</span><span class="p">,</span> <span class="s1">&#39;Night_Stalker&#39;</span><span class="p">,</span> <span class="s1">&#39;Zeus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Chaos_Knight&#39;</span><span class="p">,</span> <span class="s1">&#39;Weaver&#39;</span><span class="p">,</span> <span class="s1">&#39;Tinker&#39;</span><span class="p">,</span> <span class="s1">&#39;Huskar&#39;</span><span class="p">,</span> <span class="s1">&#39;Troll_Warlord&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Anti-Mage&#39;</span><span class="p">,</span> <span class="s1">&#39;Axe&#39;</span><span class="p">,</span> <span class="s1">&#39;Wraith_King&#39;</span><span class="p">,</span> <span class="s1">&#39;Kunkka&#39;</span><span class="p">,</span> <span class="s1">&#39;Lycan&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Bristleback&#39;</span><span class="p">,</span> <span class="s1">&#39;Outworld_Devourer&#39;</span><span class="p">,</span> <span class="s1">&#39;Riki&#39;</span><span class="p">,</span> <span class="s1">&#39;Sniper&#39;</span><span class="p">,</span> <span class="s1">&#39;Magnus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Leshrac&#39;</span><span class="p">,</span> <span class="s1">&#39;Phantom_Lancer&#39;</span><span class="p">,</span> <span class="s1">&#39;Ursa&#39;</span><span class="p">,</span> <span class="s1">&#39;Bloodseeker&#39;</span><span class="p">,</span> <span class="s1">&#39;Tiny&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Medusa&#39;</span><span class="p">,</span> <span class="s1">&#39;Morphling&#39;</span><span class="p">,</span> <span class="s1">&#39;Storm_Spirit&#39;</span><span class="p">,</span> <span class="s1">&#39;Lone_Druid&#39;</span><span class="p">,</span> <span class="s1">&#39;Death_Prophet&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Razor&#39;</span><span class="p">,</span> <span class="s1">&#39;Naga_Siren&#39;</span><span class="p">]</span>

<span class="c1"># Subset data from players in carry roles</span>
<span class="n">data_carry</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">hero_name</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">carries</span><span class="p">)]</span>

<span class="c1"># To repect independence assumption</span>
<span class="n">data_carry</span> <span class="o">=</span> <span class="n">data_carry</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_carry</span> <span class="o">=</span> <span class="n">data_carry</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;account_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Extract samples of Mid Laners and Soft Support</span>
<span class="n">data_carry_Mid</span> <span class="o">=</span> <span class="n">data_carry</span><span class="p">[</span><span class="n">data_carry</span><span class="o">.</span><span class="n">role</span> <span class="o">==</span> <span class="s1">&#39;Mid&#39;</span><span class="p">]</span>         
<span class="n">data_carry_Soft</span> <span class="o">=</span> <span class="n">data_carry</span><span class="p">[</span><span class="n">data_carry</span><span class="o">.</span><span class="n">role</span> <span class="o">==</span> <span class="s1">&#39;Soft_Support&#39;</span><span class="p">]</span>

<span class="c1"># Call function for normality test</span>
<span class="n">normality_two_sample</span><span class="p">(</span><span class="n">data1</span><span class="o">=</span> <span class="n">data_carry_Mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span>
                    <span class="n">data2</span><span class="o">=</span> <span class="n">data_carry_Soft</span><span class="o">.</span><span class="n">kills</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">At least one sample is not normal,
where the p values are: 0.000000 and 0.000000
</code></pre></td></tr></table>
</div>
</div><p>It seems that both distributions are not normal, so we can&rsquo;t proceed with a Two Sample t-test. For this reason, we&rsquo;ll use a two-sample <a href="https://www.statstutor.ac.uk/resources/uploaded/mannwhitney.pdf" target="_blank" rel="noopener noreffer">Mann-Whitney U</a> test where our hypothesis will be defined by:</p>
<ul>
<li>$H_0: P(x_{kills_{mid}} &gt; x_{kills_{soft}}) = 0.5$ (The probability that a randomly drawn player in Midlane will record more kills than a Soft Support player, is 50%)</li>
<li>$H_1: P(x_{kills_{mid}} &gt; x_{kills_{soft}}) &gt; 0.5$ (The probability that a randomly drawn player in Midlane will record more kills a Soft Support player, is more than 50%)</li>
</ul>
<p>This test makes the following assumptions:</p>
<ul>
<li>The two samples data groups are independent</li>
<li>The data elements in respective groups are continuous and not-normal</li>
</ul>
<p>Let&rsquo;s start by plotting the distributions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Load layout base objects</span>
<span class="n">sign</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">720</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Generate plot for dual distributions</span>
<span class="k">def</span> <span class="nf">dual_dist_plot</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xaxis_title</span><span class="p">,</span> <span class="n">group_names</span><span class="p">):</span>

    <span class="c1"># Subset group masks</span>
    <span class="n">group1_name</span> <span class="o">=</span> <span class="n">group_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">group2_name</span> <span class="o">=</span> <span class="n">group_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Generate array of lists and append them</span>
    <span class="n">data_grouped</span> <span class="o">=</span> <span class="p">[</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">]</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Calculate mean</span>
    <span class="n">mean_group1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
    <span class="n">mean_group2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
    
    <span class="c1"># Aesthetics</span>
    <span class="n">color_group1</span> <span class="o">=</span> <span class="s1">&#39;#00A699&#39;</span>
    <span class="n">color_group2</span> <span class="o">=</span> <span class="s1">&#39;#FC642D&#39;</span>

    <span class="c1"># Create graphic object</span>
    <span class="n">dist_groups</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_distplot</span><span class="p">(</span><span class="n">data_grouped</span><span class="p">,</span> <span class="n">group_labels</span><span class="o">=</span><span class="p">[</span><span class="n">group1_name</span><span class="p">,</span> <span class="n">group2_name</span><span class="p">],</span>
                                        <span class="n">show_rug</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_hist</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span> <span class="p">[</span><span class="n">color_group1</span><span class="p">,</span> <span class="n">color_group2</span><span class="p">])</span>
    <span class="n">dist_groups</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">mean_group1</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span> <span class="s2">&#34;dash&#34;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span> <span class="n">color_group1</span><span class="p">)</span>
    <span class="n">dist_groups</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">mean_group2</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span> <span class="s2">&#34;dash&#34;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span> <span class="n">color_group2</span><span class="p">)</span>
    <span class="n">dist_groups</span><span class="o">.</span><span class="n">add_vrect</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span> <span class="n">mean_group1</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span> <span class="n">mean_group2</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span> <span class="s2">&#34;#99AAB5&#34;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>

    <span class="c1"># Define range of value</span>
    <span class="n">dist_groups</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_range</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">all_data</span><span class="p">),</span>
                                            <span class="nb">max</span><span class="p">(</span><span class="n">all_data</span><span class="p">)])</span>
    <span class="n">dist_groups</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span> <span class="n">title</span><span class="p">,</span> <span class="n">xaxis_title</span><span class="o">=</span> <span class="n">xaxis_title</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dist_groups</span>

<span class="n">dist_groups</span> <span class="o">=</span> <span class="n">dual_dist_plot</span><span class="p">(</span><span class="n">data1</span><span class="o">=</span> <span class="n">data_carry_Mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">data2</span><span class="o">=</span> <span class="n">data_carry_Soft</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span> <span class="s1">&#39;Carry roles Kills log by Position &#39;</span><span class="p">,</span> <span class="n">xaxis_title</span><span class="o">=</span> <span class="s1">&#39;Kills log&#39;</span><span class="p">,</span>
                            <span class="n">group_names</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mid Laners&#39;</span><span class="p">,</span><span class="s1">&#39;Soft Support&#39;</span><span class="p">])</span>
<span class="n">dist_groups</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">dist_groups</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">dist_groups</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_5.png" style="width: 900px"></p>
<p>So now that we know that our sample is independent and not normal, let&rsquo;s make the hypothesis test.</p>
<p>Notice that each one of the samples under test has a size of 13,000 records approximately. Seeing that our sample is very large, the test is at risk of incurring in normality bias. To avoid this, we are going to rely on an <strong>Asymptotic P-value</strong> calculation, which will generate a standardized value given by:</p>
<p>$z = \frac{U - m_u}{\sigma_U}$</p>
<p>Which is defined by:</p>
<p>$m_U = \frac{n_{Mid} n_{Soft}}{2}$</p>
<p>And our Standard Deviation Value won&rsquo;t be affected by tied ranks, so this won&rsquo;t require any correction. This is because the categories don&rsquo;t have ranks and all the values are distinct and continuous.</p>
<p>$\sigma_U = \sqrt{\frac{n_{Mid} n_{Soft} (n_{Mid} + n_{Soft} + 1)}{12}}$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">mannwhitneyu</span>

<span class="k">def</span> <span class="nf">mannwhitneyu_est</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="n">alt</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span> <span class="n">method</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mann-Whitney Test P-value: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mannwhitneyu_est</span><span class="p">(</span><span class="n">data1</span><span class="o">=</span> <span class="n">data_carry_Mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">data2</span><span class="o">=</span> <span class="n">data_carry_Soft</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span>
                                                            <span class="n">alt</span><span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span> <span class="s1">&#39;asymptotic&#39;</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Mann-Whitney Test P-value: 0.8700862933924327
</code></pre></td></tr></table>
</div>
</div><p>Since the distributions are statistically equal seeing the p-value above 0.05, we don&rsquo;t have enough statistical evidence to reject our Null Hypothesis. This indicates that Soft Support players and Midline players tend to make the same amount of kills per session on Ranked Matchmaking mode using heroes of Carry type.</p>
<p>Now that we know this it doesn&rsquo;t make sense to separate Mid Laners from the Soft Support group, let&rsquo;s regroup these two positions and compare them with the rest of the roles.</p>
<h3 id="-two-sample-mann-whitney-test-for-kills-of-mid-lanes-and-soft-support-vs-rest-of-roles">🧝🏻👹 Two Sample Mann-Whitney Test for Kills of Mid Lanes and Soft Support vs Rest of Roles</h3>
<p>Let&rsquo;s start by defining the new hypothesis:</p>
<ul>
<li>$H_0: P(x_{kills_{mid \cup soft}} &gt; x_{kills_{rest}}) = 0.5$ (The probability that a randomly drawn player from Midlane or Soft Support will record more kills than any player, is 50%)</li>
<li>$H_1: P(x_{kills_{mid \cup soft}} &gt; x_{kills_{rest}}) &gt; 0.5$ (The probability that a randomly drawn player from Midlane or Soft Support will record more kills than any player, is more than 50%)</li>
</ul>
<p>Using the same process as before, our first assumption to check is the non-normality of the same random sample for each group.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Subset and create kills ample for carry role in Soft Support and Midlane positions</span>
<span class="n">data_soft_mid</span> <span class="o">=</span> <span class="n">data_carry</span><span class="p">[</span><span class="n">data_carry</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Soft_Support&#39;</span><span class="p">,</span> <span class="s1">&#39;Mid&#39;</span><span class="p">])]</span>

<span class="c1"># Subset and create kills sample for carry role in the rest positions</span>
<span class="n">data_not_soft_mid</span> <span class="o">=</span> <span class="n">data_carry</span><span class="p">[</span><span class="n">data_carry</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Hard_Carry&#39;</span><span class="p">,</span> <span class="s1">&#39;Hard_Support&#39;</span><span class="p">,</span> <span class="s1">&#39;Offlaner&#39;</span><span class="p">])]</span>

<span class="c1"># Call function for normality test</span>
<span class="n">normality_two_sample</span><span class="p">(</span><span class="n">data1</span><span class="o">=</span> <span class="n">data_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">data2</span><span class="o">=</span> <span class="n">data_not_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">At least one sample is not normal,
where the p values are: 0.000000 and 0.000000
</code></pre></td></tr></table>
</div>
</div><p>Now that we know the sample are not normal, we can proceed with the Mann-Whitney Test.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">dist_groups</span> <span class="o">=</span> <span class="n">dual_dist_plot</span><span class="p">(</span><span class="n">data1</span><span class="o">=</span> <span class="n">data_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">data2</span><span class="o">=</span> <span class="n">data_not_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span> <span class="s1">&#39;Carry roles Kills log by Position &#39;</span><span class="p">,</span> <span class="n">xaxis_title</span><span class="o">=</span> <span class="s1">&#39;Kills log&#39;</span><span class="p">,</span>
                            <span class="n">group_names</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mid &amp; Soft Sppt Kills&#39;</span><span class="p">,</span><span class="s1">&#39;Rest. Positions Kills&#39;</span><span class="p">])</span>
<span class="n">dist_groups</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">dist_groups</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">dist_groups</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_6.png" style="width: 900px"></p>
<p>And as well, to avoid incurring in normality bias due to the samples sizes, we are going to rely on an <strong>Asymptotic P-value</strong> calculation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mann-Whitney Test P-value: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mannwhitneyu_est</span><span class="p">(</span><span class="n">data1</span><span class="o">=</span> <span class="n">data_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">data2</span><span class="o">=</span> <span class="n">data_not_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span> <span class="s1">&#39;asymptotic&#39;</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Mann-Whitney Test P-value: 0.015672996714278714
</code></pre></td></tr></table>
</div>
</div><p>We can see that our P-Value is very close to the rejection section. However, since this is taken each time from a random sample, we can&rsquo;t conclude yet. The most accurate way to test this is to bootstrap the value and make judgments over the percentage of p-values that accept or reject our hypothesis.</p>
<p>The next function will return one array of bootstrapped estimates for the P-value, which we will describe the next:</p>
<ul>
<li>
<p><strong>p_value_mannwhitney:</strong> Proportion of P-values measured from the Mann-Whitney Test, showing the probability that a randomly drawn Midlaner or Soft Support will record more or equal quantity of kills than any player.</p>
</li>
<li>
<p><strong>boot_mannwhitney_replicates:</strong> Array of bootstrapped p-values of Mann-Whitney Test.</p>
</li>
</ul>
<p>Also, let&rsquo;s plot the bootstrapped replicates.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Bootstrapping Mann-Whitney U Test, and generate array of replicates</span>
<span class="k">def</span> <span class="nf">draw_bs_test</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
    <span class="n">boot_arr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">estimate</span> <span class="o">=</span> <span class="n">mannwhitneyu_est</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data1</span><span class="p">)),</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data2</span><span class="p">)),</span>
                                    <span class="n">alt</span><span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span> <span class="s1">&#39;asymptotic&#39;</span><span class="p">)</span>
        <span class="n">boot_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimate</span><span class="p">)</span>

    <span class="c1"># Compute and print p-value of estimate with different distributions/medians</span>
    <span class="n">p_value_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">boot_arr</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">boot_arr</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">boot_arr</span><span class="p">,</span> <span class="n">p_value_test</span>

<span class="c1"># Generates bootstrapped estimates</span>
<span class="n">boot_mannwhitney_replicates</span><span class="p">,</span> <span class="n">p_value_mannwhitney</span> <span class="o">=</span> <span class="n">draw_bs_test</span><span class="p">(</span><span class="n">data1</span><span class="o">=</span> <span class="n">data_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">data2</span><span class="o">=</span> <span class="n">data_not_soft_mid</span><span class="o">.</span><span class="n">kills</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span> <span class="mi">2000</span><span class="p">)</span>

<span class="c1"># ECDF Generator function</span>
<span class="k">def</span> <span class="nf">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># Generate ECDF (Empirical Cumulative Distribution Function) for one dimension arrays</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># X axis data</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

     <span class="c1"># Y axis data</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="c1"># ECDF plot generator</span>
<span class="k">def</span> <span class="nf">ecdf_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">var_label</span><span class="p">):</span>
    <span class="c1"># Generate ECDF data</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Generate percentile makers </span>
    <span class="n">percentiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span> <span class="n">p_value_mannwhitney</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">95</span><span class="p">])</span> <span class="c1">#Plot the percentile where the bootstrapped p-value is located</span>
    <span class="n">ptiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">)</span>

    <span class="c1"># ECDF plot</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="c1"># Add traces</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">var_label</span><span class="p">))</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ptiles</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">percentiles</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>
                        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers+text&#39;</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Percentiles&#39;</span><span class="p">,</span> <span class="n">marker_line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">text</span><span class="o">=</span><span class="n">percentiles</span><span class="p">,</span> <span class="n">textposition</span><span class="o">=</span><span class="s2">&#34;bottom right&#34;</span><span class="p">))</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">plot</span>

<span class="n">ecdf</span> <span class="o">=</span> <span class="n">ecdf_plot</span><span class="p">(</span><span class="n">boot_mannwhitney_replicates</span><span class="p">,</span> <span class="s2">&#34;P-value replicates&#34;</span><span class="p">)</span>
<span class="n">ecdf</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="s1">&#39;ECDF of Bootstrapped P-values for Mann-Whitney U Test&#39;</span><span class="p">},</span>
                        <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span><span class="s2">&#34;Cumulative Probability&#34;</span><span class="p">})</span>
<span class="n">ecdf</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_7.png" style="width: 1000px"></p>
<p>From 2000 iterations of the estimate, we can see that around ~90% of the bootstrapped Mann-Whitney U tests will have a value below 0.05 (in the hypothesis rejection zone). This indicates that the probability that a randomly drawn player from Midlaners or Soft Support will record more kills than any player is more than 50%. This approximately 90% of the time due to the significant difference in the distribution parameter.</p>
<p>With this, our next step is to restrict the analysis for Carry Heroes used in Soft Support and Midlaner positions, since these are the two positions where more kills are registered on the sessions.</p>
<p>After examining kills, we should study a more specific behavior, like the damage given to opponents by these same player records, and see if there is an unusual value in the different groups of heroes.</p>
<h3 id="-kruskalwallis-one-way-anova">🧙‍♂️ Kruskal–Wallis One-Way ANOVA</h3>
<p>First, we are going to try to test the difference between Carry heroes groups for Soft Support and Midlaners using a common One-Way ANOVA. Which is a parametric test which is used to test the statistically significant variance difference between 3 or more groups. In this case, our categorical variable will be the hero name, which will be used to segment the groups, to compare the hero damage factor between levels.</p>
<p>To select the hero groups, we can simply add the hero damage metric to use as a decision parameter, for this reason, let&rsquo;s see the cumulative metric in a Pareto chart for the Carry heroes.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Load layout for Pareto chart</span>
<span class="n">sign_pareto</span><span class="p">,</span> <span class="n">layout_pareto</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1400</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pareto_builder</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">var_value</span><span class="p">,</span> <span class="n">var_cat</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">title_xaxis</span><span class="p">,</span> <span class="n">title_yaxis</span><span class="p">):</span>

    <span class="c1"># Aggregate data by variable</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">var_cat</span><span class="p">])[</span><span class="n">var_value</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Sort data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">var_value</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Generate CumSum Percentage</span>
    <span class="n">cumulative_per</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="n">var_value</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">var_value</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">cumulative_per</span> <span class="o">=</span> <span class="n">cumulative_per</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="c1"># Append cumulative percentages column</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">cumulative_per</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Fix column names and remove last repeated value error</span>
    <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Cum_Sum&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Pareto Chart</span>
    <span class="n">pareto</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="p">[[{</span><span class="s2">&#34;secondary_y&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}]])</span>

    <span class="c1"># Bar plot graphic object</span>
    <span class="n">pareto</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var_cat</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var_value</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Hero&#34;</span><span class="p">,</span> <span class="n">marker_color</span><span class="o">=</span> <span class="s2">&#34;#007FFF&#34;</span><span class="p">),</span>
                            <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Scatter+Lines plot graphic object</span>
    <span class="n">pareto</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var_cat</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Cum_Sum&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Percentage&#34;</span><span class="p">,</span> <span class="n">marker_color</span><span class="o">=</span> <span class="s2">&#34;#FF5A5F&#34;</span><span class="p">),</span>
                            <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Layout</span>
    <span class="n">pareto</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="n">title</span><span class="p">},</span>
                        <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="n">title_xaxis</span><span class="p">},</span>
                        <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="n">title_yaxis</span><span class="p">})</span>
    <span class="n">pareto</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">tickformat</span> <span class="o">=</span> <span class="s2">&#34;0%&#34;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&#34;Cumulative Percentage&#34;</span><span class="p">,</span> <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">pareto</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">line_dash</span> <span class="o">=</span> <span class="s2">&#34;dash&#34;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&#34;red&#34;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">secondary_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pareto</span>

<span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_builder</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">data_soft_mid</span><span class="p">,</span> <span class="n">var_value</span><span class="o">=</span> <span class="s1">&#39;hero_damage&#39;</span><span class="p">,</span> <span class="n">var_cat</span><span class="o">=</span> <span class="s1">&#39;hero_name&#39;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span> <span class="s1">&#39;Pareto Chart of Hero Damage Logs&#39;</span><span class="p">,</span> <span class="n">title_xaxis</span><span class="o">=</span> <span class="s1">&#39;Heroes&#39;</span><span class="p">,</span> <span class="n">title_yaxis</span><span class="o">=</span> <span class="s1">&#39;Total Damage recorded&#39;</span><span class="p">)</span>
<span class="n">pareto</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout_pareto</span><span class="p">)</span>
<span class="n">pareto</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pareto</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_8.png" style="width: 1500px"></p>
<p>From the 110 different heroes, we&rsquo;ll consider that 20% of them approximately allocated 80% of the total damage recorded. For this reason, we are going to subset those top 28 heroes that will be under study for our ANOVA test.</p>
<p>In the last visual, due to the size of the displayed area, we are not seeing the 110 heroes, but we can see the cumulative sum of damage recorded on the right Y axis of the Pareto Chart.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Aggregate data by group</span>
<span class="n">list_sub_heroes</span> <span class="o">=</span> <span class="n">data_soft_mid</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;hero_name&#39;</span><span class="p">])[</span><span class="s1">&#39;hero_damage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Sort data</span>
<span class="n">list_sub_heroes</span> <span class="o">=</span> <span class="n">list_sub_heroes</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;hero_damage&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Extract heroes list</span>
<span class="n">list_sub_heroes</span> <span class="o">=</span> <span class="n">list_sub_heroes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">hero_name</span>

<span class="c1"># Subset data from players for analysis</span>
<span class="n">data_heroes</span> <span class="o">=</span> <span class="n">data_soft_mid</span><span class="p">[</span><span class="n">data_soft_mid</span><span class="o">.</span><span class="n">hero_name</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">list_sub_heroes</span><span class="p">)]</span>
</code></pre></td></tr></table>
</div>
</div><p>As we mentioned before, the specificity parameter is our focus point to make the right deductions, so we&rsquo;ll still narrow our analysis to Carry heroes. The situation is that an ANOVA will tell us only if there is a hero Mean Damage is different from the rest.</p>
<p>To clarify the context of why we are going to use an ANOVA test, we have two reasons; the first is to check for potential nerfed heroes in later patches, that&rsquo;s why our core KPI will be the damage, which is a continuous attribute; and the second one is that the comparison is made by a hero and fortunately we count with 28 heroes after the subset was made.</p>
<p>This way we can define the elements of the ANOVA as:</p>
<ul>
<li>Levels: Hero Names</li>
<li>Factor: Hero Damage logs</li>
</ul>
<p>And our Hypothesis will be defined by:</p>
<ul>
<li>
<p>$H_0: \overline{X}_{Windranger} = \overline{X}_{ShadowFiend} = \overline{X}_{QueenOfPain} =$   &hellip;   $= \overline{X}_{Riki}$</p>
</li>
<li>
<p>$H_1:$ At least one of the hero damage mean differ from the rest</p>
</li>
</ul>
<p>Let&rsquo;s establish the initial assumptions that we need to verify:</p>
<ul>
<li><strong>Independence validation</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Randomize order again</span>
<span class="n">data_heroes</span> <span class="o">=</span> <span class="n">data_heroes</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Prepare Levels and Factor data only</span>
<span class="n">data_heroes_anova</span> <span class="o">=</span> <span class="n">data_heroes</span><span class="p">[[</span><span class="s1">&#39;account_id&#39;</span><span class="p">,</span><span class="s1">&#39;hero_name&#39;</span><span class="p">,</span><span class="s1">&#39;hero_damage&#39;</span><span class="p">]]</span>
</code></pre></td></tr></table>
</div>
</div><p>To respect the independence assumption, we will extract one record per player in case the player count with multiple sessions logged in our sample. This is because we would prefer to have a randomized sample where the groups are <strong>mutually exclusive</strong>, since this process was made on the definition of the data_carry dataset, it&rsquo;s not necessary now.</p>
<ul>
<li><strong>Kolmogorov-Smirnov test:</strong> <a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" target="_blank" rel="noopener noreffer">check normality</a> on residuals</li>
</ul>
<p>Based on an Ordinary Least Squares model where our independent variable will be the hero_name groups and our dependant variable the hero_damage, we can generate the residual of our model.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>

<span class="c1"># Generate model to extract residuals</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;hero_damage ~ C(hero_name)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">data_heroes_anova</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Probabilty plot generator</span>
<span class="k">def</span> <span class="nf">qq_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dist_type</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="s1">&#39;&#39;&#39;
</span><span class="s1">    Requirements:
</span><span class="s1">    - scipy.stats
</span><span class="s1">    - plotly.graph_objects
</span><span class="s1">    &#39;&#39;&#39;</span>
    <span class="c1"># Generate qq plot</span>
    <span class="n">qq</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span> <span class="n">dist_type</span><span class="p">)</span>
    <span class="c1"># Take min and max value of OSM (ordered statistic medians) and generate array</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">qq</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">qq</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="c1"># Create graphic object</span>
    <span class="n">qq_plot</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="c1"># Plot OSM (Ordered Statistic Medians) in x-axis, and OSR in y-axis (Ordered Responses)</span>
    <span class="n">qq_plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">qq</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">qq</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">)</span>
    <span class="c1"># Generate linear reg line using the generated array and the OSR data as parameters</span>
    <span class="n">qq_plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">qq</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">qq</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">)</span>
    <span class="c1"># Add titles</span>
    <span class="n">qq_plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">},</span>
                        <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s1">&#39;Theorical Quantiles&#39;</span><span class="p">},</span>
                        <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s1">&#39;Ordered Values&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">qq_plot</span>

<span class="n">qq_plot</span> <span class="o">=</span> <span class="n">qq_plot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">dist_type</span><span class="o">=</span> <span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span> <span class="s2">&#34;Gaussian Probabilty Plot of ANOVA&#39;s residuals&#34;</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_9.png" style="width: 900px"></p>
<p>A visual check is helpful when the sample is large. As the sample size increases, the statistical test&rsquo;s ability to reject the null hypothesis rises, so it gains the power to detect smaller differences as the sample size n increases.</p>
<p>From the last image, we can see on the left side, that the distribution tends to spread, and considering that we rely on approximately 20,000 residuals, we can conclude non-normality. However, the best way to decide this is to test it.</p>
<p>Here we <strong>shouldn&rsquo;t use a Shapiro Welch</strong> since our sample is above 50 observations, the best way to test the Goodness to Fit a Gaussian distribution, is to use the <strong>Kolmogorov-Smirnov test</strong>. Notice that size of our data is a relatively large sample, the calculation of the p-value will perform better if we use an asymptotic method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">cdf</span><span class="o">=</span> <span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span> <span class="s1">&#39;asymp&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">KstestResult(statistic=0.5365555738561936, pvalue=0.0)
</code></pre></td></tr></table>
</div>
</div><p>We have sufficient evidence to say that the sample data does not come from a normal distribution, since our <strong>Kolmogorov-Smirnov</strong> p-value is below 0.05. Knowing this we can&rsquo;t proceed with a One-way ANOVA, so we have two options, we will proceed with a non-parametric version of ANOVA, the <a href="https://en.wikipedia.org/wiki/Kruskal%E2%80%93Wallis_one-way_analysis_of_variance" target="_blank" rel="noopener noreffer">Kruskal-Wallis</a> test.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Get Kruskal-Wallis P-value</span>
<span class="k">def</span> <span class="nf">kruskal_est</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">group_var</span><span class="p">,</span> <span class="n">value_var</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">):</span>
    <span class="c1"># Extract sample from population</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>
    <span class="c1"># Extract </span>
    <span class="n">group_names</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">group_var</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">number_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_names</span><span class="p">)</span>

    <span class="c1"># List to allocate arrays of groups</span>
    <span class="n">input_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Populate array</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_groups</span><span class="p">):</span>
        <span class="n">input_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">group_var</span><span class="p">]</span> <span class="o">==</span> <span class="n">group_names</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">value_var</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">input_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>

    <span class="c1"># Execute test over list of group arrays</span>
    <span class="n">H</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span><span class="o">*</span><span class="n">input_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">p</span> <span class="p">,</span> <span class="n">number_groups</span>

<span class="n">p</span> <span class="p">,</span> <span class="n">number_groups</span> <span class="o">=</span> <span class="n">kruskal_est</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">data_heroes_anova</span><span class="p">,</span> <span class="n">group_var</span><span class="o">=</span> <span class="s1">&#39;hero_name&#39;</span><span class="p">,</span> <span class="n">value_var</span><span class="o">=</span> <span class="s1">&#39;hero_damage&#39;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">8.112743961607323e-13
</code></pre></td></tr></table>
</div>
</div><p>The Kruskal-Wallis P-value in the rejection zone indicates that we have enough statistical evidence to reject the Null Hypothesis, meaning that at least one of the hero damage means differs from the rest.</p>
<p>Still, let&rsquo;s generate a visual of the intervals, including the mean and standard deviation, to see which of the hero groups are generating that significant difference.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">interval_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">category_col</span><span class="p">,</span> <span class="n">value_col</span><span class="p">,</span> <span class="n">max_cat</span><span class="p">):</span>
    <span class="c1"># Generate mean value and standard deviation per category</span>
    <span class="n">data_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">category_col</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
                    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">value_col_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">value_col</span><span class="p">,</span> <span class="s2">&#34;mean&#34;</span><span class="p">),</span>
                        <span class="n">value_col_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">value_col</span><span class="p">,</span> <span class="s2">&#34;std&#34;</span><span class="p">))</span>
    <span class="c1"># Select top categories by value</span>
    <span class="n">data_mean</span> <span class="o">=</span> <span class="n">data_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&#34;value_col_mean&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
                            <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">max_cat</span><span class="p">)</span>
    <span class="c1"># Generate interval plot</span>
    <span class="n">interval_plot</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_mean</span><span class="p">,</span>
                                <span class="n">x</span> <span class="o">=</span> <span class="s2">&#34;value_col_mean&#34;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">category_col</span><span class="p">,</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="n">category_col</span><span class="p">,</span> <span class="n">error_x</span> <span class="o">=</span><span class="s2">&#34;value_col_std&#34;</span><span class="p">)</span>
    <span class="c1"># Comparison line                    </span>
    <span class="n">interval_plot</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">data_mean</span><span class="p">[</span><span class="s1">&#39;value_col_mean&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line_dash</span> <span class="o">=</span> <span class="s2">&#34;dash&#34;</span><span class="p">,</span>
                            <span class="n">line_color</span><span class="o">=</span><span class="s2">&#34;grey&#34;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">interval_plot</span>

<span class="n">interval_plot</span> <span class="o">=</span> <span class="n">interval_plot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">data_heroes_anova</span><span class="p">,</span> <span class="n">category_col</span><span class="o">=</span> <span class="s2">&#34;hero_name&#34;</span><span class="p">,</span>
                                <span class="n">value_col</span><span class="o">=</span> <span class="s2">&#34;hero_damage&#34;</span><span class="p">,</span> <span class="n">max_cat</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">interval_plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">interval_plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;Interval plot for Hero Damage Logs&#34;</span><span class="p">},</span>
                            <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s1">&#39;Hero Damage&#39;</span><span class="p">},</span>
                            <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s1">&#39;Hero&#39;</span><span class="p">},</span>
                            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">interval_plot</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_10.png" style="width: 900px"></p>
<p>Effectively among 28 hero groups, we can see that there is a hero whose damage log confidence interval differs from others, this one is <a href="https://www.dota2.com/hero/zeus" target="_blank" rel="noopener noreffer">Zeus</a>, and let&rsquo;s explore his behavior overall.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Subset of attributes</span>
<span class="n">data_coord</span> <span class="o">=</span> <span class="n">data_heroes</span><span class="p">[[</span><span class="s1">&#39;hero_name&#39;</span><span class="p">,</span> <span class="s1">&#39;gold_per_min&#39;</span><span class="p">,</span> <span class="s1">&#39;hero_damage&#39;</span><span class="p">,</span> <span class="s1">&#39;tower_damage&#39;</span><span class="p">,</span> <span class="s1">&#39;victory&#39;</span><span class="p">]]</span>

<span class="c1"># Aggregations mapping</span>
<span class="n">aggregations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;gold_per_min&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;hero_damage&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;tower_damage&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;victory&#39;</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">}</span>

<span class="c1"># Extract top 6 heroes sorted by hero_damage</span>
<span class="n">data_coord</span> <span class="o">=</span> <span class="n">data_coord</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;hero_name&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">aggregations</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">data_coord</span> <span class="o">=</span> <span class="n">data_coord</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&#34;hero_damage&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Linear Scaling for numeric attributes</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_coord</span><span class="p">[</span><span class="n">data_coord</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">]:</span>
    <span class="n">data_coord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">linearScale</span><span class="p">(</span><span class="n">data_coord</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># Format for coordinates plot, vertical spread</span>
<span class="n">data_coord</span> <span class="o">=</span> <span class="n">data_coord</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;hero_name&#34;</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span> <span class="s2">&#34;attribute&#34;</span><span class="p">)</span>

<span class="c1"># Load layout base objects</span>
<span class="n">sign</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">layout_plotly</span><span class="p">(</span><span class="n">height</span><span class="o">=</span> <span class="mi">770</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="mi">1100</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Generate coordplot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line_polar</span><span class="p">(</span><span class="n">data_coord</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="s2">&#34;value&#34;</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="s2">&#34;hero_name&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;attribute&#34;</span><span class="p">,</span> <span class="n">line_close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">start_angle</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
                    <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">diverging</span><span class="o">.</span><span class="n">Portland</span><span class="p">,</span> 
                    <span class="n">template</span><span class="o">=</span><span class="s2">&#34;plotly_dark&#34;</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;toself&#39;</span><span class="p">)</span>

<span class="c1"># Assign layout</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;Interval plot for Hero Damage Logs&#34;</span><span class="p">},</span>
                            <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s1">&#39;Hero Damage&#39;</span><span class="p">},</span>
                            <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s1">&#39;Hero&#39;</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span> <span class="n">static</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p align="middle"><img src="https://raw.githubusercontent.com/robguilarr/anova_dota/master/images/plot_11.png" style="width: 900px"></p>
<p>From the linearly scaled features we visited in the last graph, we can infer two interesting insights:</p>
<ul>
<li>
<p>Shadow Fiend is the hero that presents the higher metrics in terms of gold collection, tower damage, and victories. This can be due to the &lsquo;<a href="https://dota2.fandom.com/wiki/Shadow_Fiend#Requiem_of_Souls" target="_blank" rel="noopener noreffer">Requiem of Souls</a>&rsquo; ability update, which is a wave turnover attack that was upgraded with the &ldquo;Aghanim&rsquo;s Scepter&rdquo;, one of the most used in patch <a href="https://dota2.fandom.com/wiki/Shadow_Fiend/Changelogs" target="_blank" rel="noopener noreffer">6.86</a>. And this because brings the capacity to reach a higher damage range, which was particularly useful for killing creeps and farming.</p>
</li>
<li>
<p>On the other side, Zeus has the higher damage registry, and the logs surpass by far the other heroes. This was because of several reasons, first in the patch, the developers released a remodel of the character, then this is a hero mostly used in Soft Support roles, so was probably used for Jungling, and then it is a ranged hero with one point of <a href="https://www.dota2.com/hero/zeus" target="_blank" rel="noopener noreffer">usage complexity</a>, which made more straightforward his playability.</p>
</li>
</ul>
<h2 id="-final-thoughts--takeaways">🗒️ Final thoughts &amp; takeaways</h2>
<p><strong>What can the stakeholders understand and take in consideration?</strong></p>
<p>At the beginning we were looking that the most buffed heroes, in terms of kills were different heroes like Riki, Huskar, and Ursa, however, unless we start using statistical tests applied to a behavioral metric like the damage dealt to enemies, we began noticing contrasts, where some heroes were registering higher victory values like Shadow Fiend and others high damage ranges without having superiority in term of sessions succeeded. For this reason, is preferable to base the conclusion upon statistical techniques to study subjective behaviors.</p>
<p><strong>What could the stakeholders do to take action?</strong></p>
<p>For now, the major concern of the Game Designer, should not be to take immediate action once they see this kind of insight. Instead, they can start collecting more granular data about the registries of damage logs changes, especially when abilities were introduced. Then can study two samples, one after the patch and another before, using the data archived, to run an A/B test to prove its veracity.</p>
<p><strong>What can stakeholders keep working on?</strong></p>
<p>MOBA games tend to rely their sustainability on their community engagement and this can be studied by the player’s user experience. Usually, when buffed heroes are used for Jungling, which among DOTA 2 community sometimes is a frowned upon activity, this will make the users feel uncomfortable because of unfair mechanics, so the main solution is to build a Gameplay Metrics dashboard segmented by characters to track closely its behavior and take prompter actions each time a patch is released.</p>
<hr>
<h2 id="ℹ-additional-information">ℹ️ Additional Information</h2>
<ul>
<li><strong>About the article</strong></li>
</ul>
<p>This article was developed from the content explained in the Inferential statistics section of Chapter 3 of the ‘Game Data Science book' and part of the statistical foundation was based on the book ‘Probability &amp; Statistics for Engineers &amp; Scientists’ by Walpole et. al (2016).</p>
<p>All the assumptions and the whole case scenario were developed by the author of this article, for any suggestion I want to invite you to go to my about section and contact me. Thanks to you for reading as well.</p>
<ul>
<li><strong>Related Content</strong></li>
</ul>
<p>— Dota 2 Protracker <a href="https://www.dota2protracker.com/meta" target="_blank" rel="noopener noreffer">Role Assistant</a> by Stratz</p>
<p>— Game Data Science book and additional info at the <a href="https://global.oup.com/academic/product/game-data-science-9780192897879?cc=cr&amp;lang=en&amp;" target="_blank" rel="noopener noreffer">Oxford University Press</a></p>
<p>— Anders Drachen personal <a href="https://andersdrachen.com/" target="_blank" rel="noopener noreffer">website</a></p>
<p>— DOTA 2 Balance of Power <a href="https://www.dota2.com/balanceofpower" target="_blank" rel="noopener noreffer">Patch Notes</a></p>
<ul>
<li><strong>Datasets</strong></li>
</ul>
<p>This project was developed with a dataset provided by <a href="https://github.com/albertcui" target="_blank" rel="noopener noreffer">Albert Cui</a>, <a href="https://github.com/howardchung" target="_blank" rel="noopener noreffer">Howard Chung</a>, and <a href="https://github.com/nicholashh" target="_blank" rel="noopener noreffer">Nicholas Hanson-Holtry</a>, which also can be found at <a href="https://academictorrents.com/details/5c5deeb6cfe1c944044367d2e7465fd8bd2f4acf" target="_blank" rel="noopener noreffer">YASP</a> Academic Torrents or you can experiment with this great <a href="https://www.opendota.com/explorer" target="_blank" rel="noopener noreffer">OpenDota API interface</a> to make queries.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><b>Footnote:</b> We won&rsquo;t find the raw data in the <a href="https://github.com/robguilarr/anova_dota/tree/master/DOTA_data" target="_blank" rel="noopener noreffer">Github repository</a> of this project due the storage capabilities, instead you will find a random sample with its respective preprocessing explanation in a Jupyter Notebook.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="https://robguilar.com/tags/kruskalwallis-anova/">Kruskal–Wallis ANOVA</a>
                </span><span><a href="https://robguilar.com/tags/mann-whitney-t-test/">Mann-Whitney t-test</a>
                </span><span><a href="https://robguilar.com/tags/kolmogorov-smirnov/">Kolmogorov-Smirnov</a>
                </span><span><a href="https://robguilar.com/tags/bootstrapping/">Bootstrapping</a>
                </span><span><a href="https://robguilar.com/tags/python/">Python</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>Updated on 2022-07-24</span>
            </div><div class="post-info-mod"><span>
                            <a class="link-to-markdown" href="https://robguilar.com/posts/anova_dota/index.md" target="_blank">Read Markdown</a>
                        </span></div>
        </div><div class="post-info-share">
            <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://robguilar.com/posts/anova_dota/" data-title="Assessing the Impact of Patch Releases on Digital Assets in DOTA 2" data-hashtags="Kruskal–Wallis ANOVA,Mann-Whitney t-test,Kolmogorov-Smirnov,Bootstrapping,Python"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://robguilar.com/posts/anova_dota/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://robguilar.com/posts/anova_dota/"><i class="fab fa-reddit fa-fw"></i></a></span>
        </div></div><div class="post-nav"><a href="https://robguilar.com/posts/control_mechanics_fallout/" class="prev" rel="prev" title="Exploring the Impact of Control Mechanics on User Experience in Fallout New Vegas"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="https://robguilar.com/posts/brawlstars_retention_pipeline/" class="next" rel="next" title="Optimizing User Retention in Brawl Stars: Unsupervised Machine Learning Approach to Cohorts Retention Metrics">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://robguilar.com/"></a></span>&nbsp;|&nbsp;<span class="license">Website Engine deployed by Netlify</span></div>
</div>
<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker
        .register('/sw.min.js?version=1.0.1', { scope: '/' })
        .then(() => {
            console.info('Roberto Aguilar\u00A0Service Worker Registered');
        }, err => console.error('Roberto Aguilar\u00A0Service Worker registration failed: ', err));

    navigator.serviceWorker
        .ready
        .then(() => {
            console.info('Roberto Aguilar\u00A0Service Worker Ready');
        });
}
</script>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.1-beta.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/copy-tex.min.css"><script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script src="https://cdn.jsdelivr.net/npm/object-fit-images@3.2.4/dist/ofi.min.js"></script><script src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.0/dist/autocomplete.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script src="https://cdn.jsdelivr.net/npm/twemoji@13.1.0/dist/twemoji.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.1-beta.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.1/sharer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/mhchem.min.js"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":30},"comment":{},"data":{"id-1":" \u003e robguilar","id-2":" \u003e robguilar"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true,"typeit":{"cursorChar":"|","cursorSpeed":900,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":90}};</script><script src="https://robguilar.com/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-603CX8ERRB');
        </script><script src="https://www.googletagmanager.com/gtag/js?id=G-603CX8ERRB" async></script><script data-goatcounter="https://robguilar.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>
